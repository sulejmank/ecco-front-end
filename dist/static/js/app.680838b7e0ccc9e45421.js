webpackJsonp([1],{0:function(t,e){},1:function(t,e){},"20Zl":function(t,e){},"24Rw":function(t,e){},"2FH9":function(t,e){},"2eV2":function(t,e){},"4Oz7":function(t,e){},"7zck":function(t,e){},"95uG":function(t,e){},BoQZ:function(t,e){},BrRV:function(t,e){},CDOh:function(t,e){},DanA:function(t,e){},DsJ9:function(t,e){},ETPZ:function(t,e){},"G+Ip":function(t,e){},HBP1:function(t,e){},IK0C:function(t,e){},IjOH:function(t,e){},KEAq:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("u7Vc"),a("7zck");var n=a("7+uW"),s=a("3EgV"),r=a.n(s),i=a("/ocq"),o=a("Xxa5"),l=a.n(o),c=a("mvHQ"),u=a.n(c),d=a("exGp"),v=a.n(d),p=a("Zrlr"),m=a.n(p),g=function t(e,a,n,s,r,i){m()(this,t),this.id=null,this.name=e||null,this.surname=a||null,this.email=n||null,this.username=s||null,this.password=r||null,this.role=i||null},f=a("//Fk"),h=a.n(f),k=a("wxAW"),_=a.n(k),b=a("mtWM"),x=a.n(b),j=(a("20Zl"),a("YxSy")),y=a.n(j),w={error:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Greska";return y.a.error({title:e,message:t,position:"topRight"})},success:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Success";return y.a.success({title:e,message:t,position:"bottomRight"})}},D=a("OAwv"),P=a.n(D),C=function(){function t(){m()(this,t),x.a.defaults.withCredentials=!0,x.a.defaults.crossDomain=!0,x.a.defaults.handleErrors=!1,this.baseUrl="https://api.ecco.rs",x.a.interceptors.response.use(function(t){return t},this.errorResponseHandler)}return _()(t,[{key:"errorResponseHandler",value:function(t){return t.config.hasOwnProperty("errorHandle")&&!1===t.config.errorHandle?h.a.reject(t):t.response?(w.error(t.response.data.message),t):void 0}},{key:"getSuggestedCustomers",value:function(t){return x.a.get(this.baseUrl+"/api/relevant/client?search="+t)}},{key:"getSuggestedPassanger",value:function(t){return x.a.get(this.baseUrl+"/api/relevant/passanger?search="+t)}},{key:"getCompanySuggestion",value:function(t){return x.a.get(this.baseUrl+"/api/relevant/company?search="+t)}},{key:"getAgentSuggestion",value:function(t){return x.a.get(this.baseUrl+"/api/relevant/agent?search="+t)}},{key:"getHotelSuggestion",value:function(t){return x.a.get(this.baseUrl+"/api/relevant/hotel?search="+t)}},{key:"deleteCustomer",value:function(t){return x.a.post(this.baseUrl+"/api/client/"+t)}},{key:"uploadPhoto",value:function(t){var e=new FormData;return e.append("image",t.target.files[0]),x.a.post(this.baseUrl+"/api/upload",P.a.stringify(e))}},{key:"saveCustomer",value:function(t){return delete t.updatedAt,delete t.createdAt,delete t.kupac,x.a.post(this.baseUrl+"/api/addClient",P.a.stringify(t))}},{key:"addPassenger",value:function(t,e){return x.a.post(this.baseUrl+"/api/addtoang",P.a.stringify({idPutnika:e,idAngazmana:t}))}},{key:"getAngazmani",value:function(){return x.a.get(this.baseUrl+"/api/angazmani")}},{key:"saveArrangement",value:function(t){return x.a.post(this.baseUrl+"/api/arrangement",P.a.stringify(t))}},{key:"savePlan",value:function(t){return x.a.post(this.baseUrl+"/api/plan",P.a.stringify(t))}},{key:"savePassanger",value:function(t){return x.a.post(this.baseUrl+"/api/passanger",P.a.stringify(t))}},{key:"savePassangerWithRoom",value:function(t){return x.a.post(this.baseUrl+"/api/passanger/room",P.a.stringify(t))}},{key:"saveRoom",value:function(t){return x.a.post(this.baseUrl+"/api/room",P.a.stringify(t))}},{key:"saveTicket",value:function(t){return x.a.post(this.baseUrl+"/api/ticket",P.a.stringify(t))}},{key:"getKarte",value:function(){return x.a.get(this.baseUrl+"/api/karte")}},{key:"checkTicket",value:function(t){return x.a.post(this.baseUrl+"/api/ticket/check",P.a.stringify({id:t}))}},{key:"uncheckTicket",value:function(t){return x.a.post(this.baseUrl+"/api/ticket/uncheck",P.a.stringify({id:t}))}},{key:"getPutnik",value:function(t){return x.a.post(this.baseUrl+"/api/putnik",P.a.stringify({id:t}))}},{key:"getNoveKupovine",value:function(){return x.a.get(this.baseUrl+"/api/purchases")}},{key:"getCustomers",value:function(){return x.a.get(this.baseUrl+"/api/list")}},{key:"getFlightTickets",value:function(){return x.a.get(this.baseUrl+"/api/tickets/flight")}},{key:"getBusTickets",value:function(){return x.a.get(this.baseUrl+"/api/tickets/bus")}},{key:"getTickets",value:function(t){return x.a.get(this.baseUrl+"/api/tickets/"+t)}},{key:"getArrangements",value:function(){return x.a.get(this.baseUrl+"/api/arrangements")}},{key:"getPlaceSuggestion",value:function(t){return x.a.get(this.baseUrl+"/api/search?input="+encodeURI(t))}},{key:"updatePlan",value:function(t){return x.a.put(this.baseUrl+"/api/plan/"+t.id,P.a.stringify(t))}},{key:"euroToRsd",value:function(){return x.a.get("https://free.currencyconverterapi.com/api/v5/convert?q=EUR_RSD&compact=y&callback=sampleCallback")}},{key:"getPlans",value:function(){return x.a.get(this.baseUrl+"/api/plans")}},{key:"getPlansById",value:function(t){return x.a.get(this.baseUrl+"/api/plan/"+t)}},{key:"getCustomerById",value:function(t){return x.a.get(this.baseUrl+"/api/client/"+t)}},{key:"deletePlansById",value:function(t){return x.a.get(this.baseUrl+"/api/plan/"+t+"/delete")}},{key:"login",value:function(t,e){return x.a.post(this.baseUrl+"/api/login",P.a.stringify({username:t,password:e}))}},{key:"logout",value:function(){return x.a.post(this.baseUrl+"/api/logout")}},{key:"isLoggedIn",value:function(){return x.a.get(this.baseUrl+"/api/isLoggedin")}},{key:"getBillInWordDocument",value:function(t){return x.a.get(this.baseUrl+"/api/bill/"+t,{responseType:"blob"})}},{key:"getBillPreviewInWordDocument",value:function(t){return x.a.get(this.baseUrl+"/api/billPreview/"+t)}},{key:"removePreviewBill",value:function(t){return x.a.post(this.baseUrl+"/api/billRemove/"+t)}},{key:"makePayment",value:function(t,e){return x.a.post(this.baseUrl+"/api/payment/"+t,P.a.stringify(e))}},{key:"getAllPayments",value:function(t){return x.a.get(this.baseUrl+"/api/payment/"+t)}},{key:"deletePayment",value:function(t){return x.a.delete(this.baseUrl+"/api/payment/"+t)}},{key:"getTicketById",value:function(t){return x.a.get(this.baseUrl+"/api/ticket/"+t)}},{key:"saveChangedTicket",value:function(t){return x.a.put(this.baseUrl+"/api/ticket/"+t.id,P.a.stringify(t))}},{key:"saveChangedArrangement",value:function(t){return x.a.put(this.baseUrl+"/api/arrangement/"+t.id,P.a.stringify(t))}},{key:"saveDestination",value:function(t){return x.a.post(this.baseUrl+"/api/destination",P.a.stringify(t))}},{key:"removeAllPassangersFromTicket",value:function(t){return x.a.post(this.baseUrl+"/api/passanger/tickets/"+t)}},{key:"removeAllRoomsFromArrangement",value:function(t){return x.a.post(this.baseUrl+"/api/room/arrangement/"+t)}},{key:"getPicklist",value:function(t){return x.a.get(this.baseUrl+"/api/picklist?delimeter="+t)}},{key:"getDestinations",value:function(){return x.a.get(this.baseUrl+"/api/destinations")}},{key:"getAllUsers",value:function(){return x.a.get(this.baseUrl+"/api/users")}},{key:"addUser",value:function(t){return x.a.post(this.baseUrl+"/api/user",P.a.stringify(t))}},{key:"deleteUser",value:function(t){return x.a.delete(this.baseUrl+"/api/user/"+t)}},{key:"addPicklistOption",value:function(t){return x.a.post(this.baseUrl+"/api/picklist",P.a.stringify(t))}},{key:"deletePicklistOption",value:function(t){return x.a.delete(this.baseUrl+"/api/picklist/"+t)}},{key:"addCompany",value:function(t){return x.a.post(this.baseUrl+"/api/company",P.a.stringify(t))}},{key:"addClientAsPassanger",value:function(t,e,a){return x.a.post(this.baseUrl+"/api/passanger/"+e+"/ticket/"+t,P.a.stringify({brojRezervacije:a}))}},{key:"getCompanies",value:function(){return x.a.get(this.baseUrl+"/api/companies")}},{key:"deleteCompany",value:function(t){return x.a.delete(this.baseUrl+"/api/company/"+t)}},{key:"addAgent",value:function(t){return x.a.post(this.baseUrl+"/api/agent",P.a.stringify({name:t,id:null}))}},{key:"getAgents",value:function(){return x.a.get(this.baseUrl+"/api/agents")}},{key:"deleteAgent",value:function(t){return x.a.delete(this.baseUrl+"/api/agent/"+t)}},{key:"addHotel",value:function(t){return x.a.post(this.baseUrl+"/api/hotel",P.a.stringify({name:t,id:null}))}},{key:"getHotels",value:function(){return x.a.get(this.baseUrl+"/api/hotels")}},{key:"deleteHotel",value:function(t){return x.a.delete(this.baseUrl+"/api/hotel/"+t)}},{key:"addPassangerOnArrangement",value:function(t){return x.a.post(this.baseUrl+"/api/passanger/arrangement",P.a.stringify(t))}},{key:"removeAllPassangersFromArrangement",value:function(t){return x.a.post(this.baseUrl+"/api/passanger/arrangement/"+t)}},{key:"setClientAsPassangerOnArrangement",value:function(t,e){return x.a.post(this.baseUrl+"/api/passanger/"+t+"/arrangement/"+e)}},{key:"getCustomerStatistics",value:function(){return x.a.get(this.baseUrl+"/api/statistics/customers")}},{key:"getDestinationsStatistics",value:function(){return x.a.get(this.baseUrl+"/api/statistics/destinations")}},{key:"generateMemorandum",value:function(t){return x.a.post(this.baseUrl+"/api/upload/"+t)}},{key:"downloadFile",value:function(t){return x.a.get(this.baseUrl+"/api/download/"+t,{dataType:"binary",responseType:"arraybuffer",timeout:3e4,processData:!1})}}]),t}(),S={name:"LogIn",data:function(){return{user:new g,api:new C,showError:!1}},methods:{login:function(){var t=this;return v()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.login(t.user.username,t.user.password);case 2:a=e.sent,t.$store.commit("setLoggedInUser",a.data),window.localStorage.setItem("user",u()(a.data)),Ne.push({path:"/dashboard"});case 6:case"end":return e.stop()}},e,t)}))()}}},A={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-content",[a("v-container",{attrs:{fluid:"","fill-height":"","grid-list-md":"","text-xs-center":""}},[a("v-layout",{attrs:{row:"","align-center":"","justify-center":"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[a("v-card",{staticClass:"elevation-12"},[a("v-toolbar",[a("v-toolbar-title",[t._v("Login")])],1),t._v(" "),a("v-card-text",[a("v-form",[a("v-text-field",{attrs:{"prepend-icon":"person",name:"login",label:"Login",type:"text"},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}}),t._v(" "),a("v-text-field",{attrs:{id:"password","prepend-icon":"lock",name:"password",label:"Password",type:"password"},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}})],1)],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{on:{click:t.login}},[t._v("Login")])],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var M=a("VU/8")(S,A,!1,function(t){a("IjOH")},null,null).exports,O=a("PJh5"),I=a.n(O),z={name:"PicklistOption",props:{picklist:{type:Object}},data:function(){return{valid:!1,titleRules:[function(t){return!!t||"Naslov opcije je obavezan podatak"}]}},computed:{isValid:function(){return this.$refs.picklistForm.validate()}},methods:{},watch:{},mounted:function(){}},R={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-form",{ref:"picklistForm",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-text-field",{attrs:{rules:t.titleRules,label:"Naslov Opcije",required:""},model:{value:t.picklist.title,callback:function(e){t.$set(t.picklist,"title",e)},expression:"picklist.title"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-textarea",{attrs:{solo:"","elevation-3":"",name:"input-7-4",label:"Opis Opcije"},model:{value:t.picklist.description,callback:function(e){t.$set(t.picklist,"description",e)},expression:"picklist.description"}})],1)],1)],1)],1)},staticRenderFns:[]};var T=a("VU/8")(z,R,!1,function(t){a("HBP1")},null,null).exports,Y=function t(e,a,n,s){m()(this,t),this.id=null,this.title=n||null,this.delimeter=e||null,this.description=s||null,this.value=null},U={name:"Company",props:{company:{type:Object}},data:function(){return{valid:!1,nameRules:[function(t){return!!t||"Ime Kompanije je obavezan podatak"}]}},computed:{isValid:function(){return this.$refs.companyForm.validate()}},methods:{},watch:{},mounted:function(){}},$={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-form",{ref:"companyForm",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-text-field",{attrs:{rules:t.nameRules,label:"Ime Kompanije",required:""},model:{value:t.company.name,callback:function(e){t.$set(t.company,"name",e)},expression:"company.name"}})],1)],1)],1)],1)},staticRenderFns:[]};var L=a("VU/8")(U,$,!1,function(t){a("ZqOc")},null,null).exports,N=function t(e,a){m()(this,t),this.id=e||null,this.name=a||null},E={name:"Hotel",props:{hotel:{type:Object}},data:function(){return{valid:!1,nameRules:[function(t){return!!t||"Ime Hotela je obavezan podatak"}]}},computed:{isValid:function(){return this.$refs.hotelForm.validate()}},methods:{},watch:{},mounted:function(){}},V={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-form",{ref:"hotelForm",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-text-field",{attrs:{rules:t.nameRules,label:"Ime Hotela",required:""},model:{value:t.hotel.name,callback:function(e){t.$set(t.hotel,"name",e)},expression:"hotel.name"}})],1)],1)],1)],1)},staticRenderFns:[]};var H=a("VU/8")(E,V,!1,function(t){a("DsJ9")},null,null).exports,F=function t(e,a){m()(this,t),this.id=e||null,this.name=a||null},K={name:"Agent",props:{agent:{type:Object}},data:function(){return{valid:!1,nameRules:[function(t){return!!t||"Ime Agenta je obavezan podatak"}]}},computed:{isValid:function(){return this.$refs.agentForm.validate()}},methods:{},watch:{},mounted:function(){}},B={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-form",{ref:"agentForm",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-text-field",{attrs:{rules:t.nameRules,label:"Ime Agenta",required:""},model:{value:t.agent.name,callback:function(e){t.$set(t.agent,"name",e)},expression:"agent.name"}})],1)],1)],1)],1)},staticRenderFns:[]};var q=function t(e,a){m()(this,t),this.id=e||null,this.name=a||null},Z={name:"Settings",components:{picklist:T,company:L,hotel:H,agent:a("VU/8")(K,B,!1,function(t){a("lE22")},null,null).exports},data:function(){return{api:new C,picklistModal:!1,picklist:new Y,company:new N,hotel:new F,agent:new q,updateSettings:0,updateCompany:0,updateDestinations:0,conformationDialog:!1,conformationCompanyDialog:!1,companyModal:!1,deletePicklistId:0,deleteCompanyId:0,deleteAgentId:0,deleteHotelId:0,updateAgents:0,updateHotels:0,conformationAgentDialog:!1,agentModal:!1,conformationHotelDialog:!1,hotelModal:!1}},asyncComputed:{servicePicklist:{get:function(){return this.api.getPicklist("service").then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateSettings}},arrangmentTypePicklist:{get:function(){return this.api.getPicklist("arrangement").then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateSettings}},roomContents:{get:function(){return this.api.getPicklist("room-content").then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateSettings}},roomTypes:{get:function(){return this.api.getPicklist("room-type").then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateSettings}},companies:{get:function(){return this.api.getCompanies().then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateCompany}},destinations:{get:function(){return this.api.getDestinations().then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateDestinations}},agents:{get:function(){return this.api.getAgents().then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateAgents}},hotels:{get:function(){return this.api.getHotels().then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateHotels}}},methods:{addNewCompany:function(){this.company=new N,this.companyModal=!0},addNewAgent:function(){this.agent=new q,this.agentModal=!0},addNewHotel:function(){this.hotel=new F,this.hotelModal=!0},addNewOption:function(t){this.picklist=new Y(t),this.picklistModal=!0},closePicklistModal:function(){this.picklistModal=!1,this.picklist=new Y},removePicklistOption:function(t){this.deletePicklistId=t.id,this.conformationDialog=!0},editPicklistOption:function(t){this.picklist=t,this.picklistModal=!0},editCompany:function(t){this.company=t,this.companyModal=!0},editHotel:function(t){this.hotel=t,this.hotelModal=!0},editAgent:function(t){this.agent=t,this.agentModal=!0},closeCompanyModal:function(){this.companyModal=!1,this.company=new N},closeAgentModal:function(){this.agentModal=!1,this.agent=new q},closeHotelModal:function(){this.hotelModal=!1,this.hotel=new F},removeCompany:function(t){this.deleteCompanyId=t.id,this.conformationCompanyDialog=!0},removeAgent:function(t){this.deleteAgentId=t.id,this.conformationAgentDialog=!0},removeHotel:function(t){this.deleteHotelId=t.id,this.conformationHotelDialog=!0},deleteCompany:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.deleteCompany(t.deleteCompanyId);case 3:e.sent,t.updateCompany=new Date,t.conformationCompanyDialog=!1,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),w.error(e.t0.toString());case 11:case"end":return e.stop()}},e,t,[[0,8]])}))()},deleteAgent:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.deleteAgent(t.deleteAgentId);case 3:e.sent,t.updateAgents=new Date,t.conformationAgentDialog=!1,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),w.error(e.t0.toString());case 11:case"end":return e.stop()}},e,t,[[0,8]])}))()},deleteHotel:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.deleteHotel(t.deleteHotelId);case 3:e.sent,t.updateHotels=new Date,t.conformationHotelDialog=!1,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),w.error(e.t0.toString());case 11:case"end":return e.stop()}},e,t,[[0,8]])}))()},addCompany:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.company.isValid){e.next=12;break}return e.prev=1,e.next=4,t.api.addCompany(t.company);case 4:e.sent,t.updateCompany=new Date,t.companyModal=!1,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),w.error(e.t0.toString());case 12:case"end":return e.stop()}},e,t,[[1,9]])}))()},addAgent:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.agent.isValid){e.next=12;break}return e.prev=1,e.next=4,t.api.addAgent(t.agent);case 4:e.sent,t.updateAgents=new Date,t.agentModal=!1,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),w.error(e.t0.toString());case 12:case"end":return e.stop()}},e,t,[[1,9]])}))()},addHotel:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.hotel.isValid){e.next=12;break}return e.prev=1,e.next=4,t.api.addHotel(t.hotel);case 4:e.sent,t.updateHotels=new Date,t.hotelModal=!1,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),w.error(e.t0.toString());case 12:case"end":return e.stop()}},e,t,[[1,9]])}))()},deleteOption:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.deletePicklistOption(t.deletePicklistId);case 3:e.sent,t.updateSettings=new Date,t.conformationDialog=!1,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),w.error(e.t0.toString());case 11:case"end":return e.stop()}},e,t,[[0,8]])}))()},addPicklistOption:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.picklist.isValid){e.next=12;break}return e.prev=1,e.next=4,t.api.addPicklistOption(t.picklist);case 4:e.sent,t.updateSettings=new Date,t.picklistModal=!1,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),w.error(e.t0.toString());case 12:case"end":return e.stop()}},e,t,[[1,9]])}))()}}},W={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-layout",{attrs:{"align-center":"",row:""}},[a("v-flex",{attrs:{xs12:"",sm6:"",md4:"",lg3:"","mx-2":""}},[a("v-card",{staticClass:"cart"},[a("v-card-title",[a("h4",[t._v("List Usluga")])]),t._v(" "),a("v-divider"),t._v(" "),t.servicePicklist?a("v-list",{staticClass:"scrollable-list",attrs:{dense:""}},t._l(t.servicePicklist,function(e){return a("v-list-tile",{key:e.id},[a("v-list-tile-content",[t._v(t._s(e.title))]),t._v(" "),a("v-list-tile-action",{staticClass:"custom-tile-action"},[a("v-btn",{attrs:{icon:""},on:{click:function(a){t.editPicklistOption(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("edit")])],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(a){t.removePicklistOption(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)],1)})):t._e(),t._v(" "),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",right:"",color:"green"},on:{click:function(e){t.addNewOption(t.servicePicklist[0].delimeter)}}},[a("v-icon",[t._v("add")])],1)],1)],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md4:"",lg3:"","mx-2":""}},[a("v-card",{staticClass:"cart"},[a("v-card-title",[a("h4",[t._v("Tipovi Aranžmana")])]),t._v(" "),a("v-divider"),t._v(" "),t.arrangmentTypePicklist?a("v-list",{staticClass:"scrollable-list",attrs:{dense:""}},t._l(t.arrangmentTypePicklist,function(e){return a("v-list-tile",{key:e.id},[a("v-list-tile-content",[t._v(t._s(e.title))]),t._v(" "),a("v-list-tile-action",{staticClass:"custom-tile-action"},[a("v-btn",{attrs:{icon:""},on:{click:function(a){t.editPicklistOption(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("edit")])],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(a){t.removePicklistOption(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)],1)})):t._e(),t._v(" "),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",right:"",color:"green"},on:{click:function(e){t.addNewOption(t.arrangmentTypePicklist[0].delimeter)}}},[a("v-icon",[t._v("add")])],1)],1)],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md4:"",lg3:"","mx-2":""}},[a("v-card",{staticClass:"cart"},[a("v-card-title",[a("h4",[t._v("Struktura sobe")])]),t._v(" "),a("v-divider"),t._v(" "),t.roomContents?a("v-list",{staticClass:"scrollable-list",attrs:{dense:""}},t._l(t.roomContents,function(e){return a("v-list-tile",{key:e.id},[a("v-list-tile-content",[t._v(t._s(e.title))]),t._v(" "),a("v-list-tile-action",{staticClass:"custom-tile-action"},[a("v-btn",{attrs:{icon:""},on:{click:function(a){t.editPicklistOption(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("edit")])],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(a){t.removePicklistOption(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)],1)})):t._e(),t._v(" "),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",right:"",color:"green"},on:{click:function(e){t.addNewOption(t.roomContents[0].delimeter)}}},[a("v-icon",[t._v("add")])],1)],1)],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md4:"",lg3:"","mx-2":""}},[a("v-card",{staticClass:"cart"},[a("v-card-title",[a("h4",[t._v("Tipovi Soba")])]),t._v(" "),a("v-divider"),t._v(" "),t.roomTypes?a("v-list",{staticClass:"scrollable-list",attrs:{dense:""}},t._l(t.roomTypes,function(e){return a("v-list-tile",{key:e.id},[a("v-list-tile-content",[t._v(t._s(e.title))]),t._v(" "),a("v-list-tile-action",{staticClass:"custom-tile-action"},[a("v-btn",{attrs:{icon:""},on:{click:function(a){t.editPicklistOption(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("edit")])],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(a){t.removePicklistOption(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)],1)})):t._e(),t._v(" "),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",right:"",color:"green"},on:{click:function(e){t.addNewOption(t.roomTypes[0].delimeter)}}},[a("v-icon",[t._v("add")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.picklistModal,callback:function(e){t.picklistModal=e},expression:"picklistModal"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Nova Opcija")])]),t._v(" "),a("picklist",{ref:"picklist",attrs:{picklist:t.picklist}}),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.closePicklistModal(e)}}},[t._v("Zatvori")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.addPicklistOption(e)}}},[t._v(t._s(null==t.picklist.id?"Dodaj Opciju":"Izmeni Opciju"))])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.conformationDialog,callback:function(e){t.conformationDialog=e},expression:"conformationDialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Upozorenje")])]),t._v(" "),a("v-card-text",[a("p",[t._v("Da li zelite izbrisati ovu opciju ?")])]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.conformationDialog=!1}}},[t._v("Odustani")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deleteOption(e)}}},[t._v("Nastavi")])],1)],1)],1)],1),t._v(" "),a("v-layout",{attrs:{"align-center":"",row:"","mt-5":""}},[a("v-flex",{attrs:{xs12:"",sm6:"",md4:"",lg3:"","mx-2":""}},[a("v-card",{staticClass:"cart"},[a("v-card-title",[a("h4",[t._v("List Kompanija")])]),t._v(" "),a("v-divider"),t._v(" "),t.companies?a("v-list",{staticClass:"scrollable-list",attrs:{dense:""}},t._l(t.companies,function(e){return a("v-list-tile",{key:e.id},[a("v-list-tile-content",[t._v(t._s(e.name))]),t._v(" "),a("v-list-tile-action",{staticClass:"custom-tile-action"},[a("v-btn",{attrs:{icon:""},on:{click:function(a){t.editCompany(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("edit")])],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(a){t.removeCompany(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)],1)})):t._e(),t._v(" "),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",right:"",color:"green"},on:{click:function(e){t.addNewCompany()}}},[a("v-icon",[t._v("add")])],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.companyModal,callback:function(e){t.companyModal=e},expression:"companyModal"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Nova Opcija")])]),t._v(" "),a("company",{ref:"company",attrs:{company:t.company}}),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.closeCompanyModal(e)}}},[t._v("Zatvori")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.addCompany(e)}}},[t._v(t._s(null==t.company.id?"Dodaj Kompaniju":"Izmeni Kompaniju"))])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.conformationCompanyDialog,callback:function(e){t.conformationCompanyDialog=e},expression:"conformationCompanyDialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Upozorenje")])]),t._v(" "),a("v-card-text",[a("p",[t._v("Da li zelite izbrisati ovu Kompaniju ?")])]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.conformationCompanyDialog=!1}}},[t._v("Odustani")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deleteCompany(e)}}},[t._v("Nastavi")])],1)],1)],1)],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md4:"",lg3:"","mx-2":""}},[a("v-card",{staticClass:"cart"},[a("v-card-title",[a("h4",[t._v("Lista Agenata")])]),t._v(" "),a("v-divider"),t._v(" "),t.agents?a("v-list",{staticClass:"scrollable-list",attrs:{dense:""}},t._l(t.agents,function(e){return a("v-list-tile",{key:e.id},[a("v-list-tile-content",[t._v(t._s(e.name))]),t._v(" "),a("v-list-tile-action",{staticClass:"custom-tile-action"},[a("v-btn",{attrs:{icon:""},on:{click:function(a){t.editAgent(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("edit")])],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(a){t.removeAgent(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)],1)})):t._e(),t._v(" "),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",right:"",color:"green"},on:{click:function(e){t.addNewAgent()}}},[a("v-icon",[t._v("add")])],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.agentModal,callback:function(e){t.agentModal=e},expression:"agentModal"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Novi Agent")])]),t._v(" "),a("agent",{ref:"agent",attrs:{agent:t.agent}}),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.closeAgentModal(e)}}},[t._v("Zatvori")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.addAgent(e)}}},[t._v(t._s(null==t.agent.id?"Dodaj Agenta":"Izmeni Agenta"))])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.conformationAgentDialog,callback:function(e){t.conformationAgentDialog=e},expression:"conformationAgentDialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Upozorenje")])]),t._v(" "),a("v-card-text",[a("p",[t._v("Da li zelite izbrisati Agenta ?")])]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.conformationAgentDialog=!1}}},[t._v("Odustani")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deleteAgent(e)}}},[t._v("Nastavi")])],1)],1)],1)],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm6:"",md4:"",lg3:"","mx-2":""}},[a("v-card",{staticClass:"cart"},[a("v-card-title",[a("h4",[t._v("Lista Hotela")])]),t._v(" "),a("v-divider"),t._v(" "),t.hotels?a("v-list",{staticClass:"scrollable-list",attrs:{dense:""}},t._l(t.hotels,function(e){return a("v-list-tile",{key:e.id},[a("v-list-tile-content",[t._v(t._s(e.name))]),t._v(" "),a("v-list-tile-action",{staticClass:"custom-tile-action"},[a("v-btn",{attrs:{icon:""},on:{click:function(a){t.editHotel(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("edit")])],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(a){t.removeHotel(e)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)],1)})):t._e(),t._v(" "),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",right:"",color:"green"},on:{click:function(e){t.addNewHotel()}}},[a("v-icon",[t._v("add")])],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.hotelModal,callback:function(e){t.hotelModal=e},expression:"hotelModal"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Novi Hotel")])]),t._v(" "),a("hotel",{ref:"hotel",attrs:{hotel:t.hotel}}),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.closeHotelModal(e)}}},[t._v("Zatvori")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.addHotel(e)}}},[t._v(t._s(null==t.hotel.id?"Dodaj Hotel":"Izmeni Hotel"))])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.conformationHotelDialog,callback:function(e){t.conformationHotelDialog=e},expression:"conformationHotelDialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Upozorenje")])]),t._v(" "),a("v-card-text",[a("p",[t._v("Da li zelite izbrisati Hotel ?")])]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.conformationHotelDialog=!1}}},[t._v("Odustani")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deleteHotel(e)}}},[t._v("Nastavi")])],1)],1)],1)],1)],1),t._v(" "),a("v-layout",{attrs:{"align-center":"",row:"","mt-5":""}},[a("v-flex",{attrs:{sm12:"",md12:"",lg6:"","offset-lg3":"","mx-2":""}},[a("v-card",{staticClass:"cart"},[a("v-card-title",[a("h4",[t._v("Destinacije")])]),t._v(" "),a("v-divider"),t._v(" "),t.destinations?a("v-list",{staticClass:"scrollable-list",attrs:{dense:""}},t._l(t.destinations,function(e){return a("v-list-tile",{key:e.id},[a("v-list-tile-content",[a("v-checkbox",{attrs:{"input-value":e.active,label:e.destinacija,primary:"","hide-details":""}})],1),t._v(" "),a("v-list-tile-action",{staticClass:"custom-tile-action"},[a("v-btn",{attrs:{icon:""},on:{click:function(e){t.editPicklistOption(t.setting)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("edit")])],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(e){t.removePicklistOption(t.setting)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)],1)})):t._e(),t._v(" "),a("v-btn",{attrs:{absolute:"",dark:"",fab:"",bottom:"",right:"",color:"green"}},[a("v-icon",[t._v("add")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var G=a("VU/8")(Z,W,!1,function(t){a("BoQZ")},null,null).exports,J=function t(e,a,n,s,r,i,o){m()(this,t),this.id=e||0,this.ClientId=a||0,this.totalnaCena=n||0,this.status=s||!1,this.avans=i||0,this.rokUplate=r||null,this.napomena=o||null},X=function t(e,a){m()(this,t),this.paymentDate=e||I()().format("YYYY-MM-DD"),this.payment=a||""},Q={name:"Payment",props:{plan:{type:Object},payment:{type:Object}},data:function(){var t=this;return{amountRule:[function(t){return!!t||"Kolicina uplate je obavezan podatak"}],paymentDateRules:[function(e){return!!t.payment.paymentDate||"Datum uplate je obavezan podatak"},function(t){return I()(t,"DD.MM.YYYY").isValid()||"Datum uplate nije validan, koristite format dan.mesec.godina"},function(t){return new Date(I()(t,"DD.MM.YYYY"))>new Date||"Datum uplate polaska se ne nalazi u buducnosti"}],paymentDate:null,valid:!1,menu:!1,api:new C,paymentHeaders:[{text:"Akcije",align:"left",sortable:!1},{text:"Datum Uplate",align:"left",sortable:!1},{text:"Kolicina Uplate",align:"left",sortable:!1}]}},computed:{paymentValid:function(){return this.$refs.paymentForm.validate()},total:function(){return this.totalWithoutAvans+parseInt(this.plan.avans||0)},totalWithoutAvans:function(){return null==this.payments?0:this.payments.reduce(function(t,e){return t+=parseInt(e.payment)},0)},rest:function(){return null==this.plan.neto&&console.log(this.plan),this.plan.totalnaCena-this.total},paymentDateModel:function(){return this.payment.paymentDate}},asyncComputed:{payments:{get:function(){return this.api.getAllPayments(this.plan.id).then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.plan.id}}},methods:{resetValidation:function(){this.$refs.paymentForm.reset()},formatISODate:function(t){return null==t?"-":I()(t,I.a.ISO_8601).format("DD MMM YYYY")},limitInput:function(t){parseInt(this.rest)<parseInt(t)&&(this.payment.payment=this.rest)},parseDate:function(t){return t?I()(t,"DD.MM.YYYY").format("YYYY-MM-DD").toString():null}},watch:{paymentDateModel:function(t){this.paymentDate=I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()}}},tt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[t.payments?a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.paymentHeaders,items:t.payments,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("td",{staticClass:"justify-center layout px-0"},[a("v-icon",{attrs:{small:""},on:{click:function(a){t.$emit("deletePayment",e.item.id)}}},[t._v("\n          delete\n        ")])],1),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(t.formatISODate(e.item.paymentDate)))]),t._v(" "),a("td",{staticClass:"text-xs-center"},[t._v(t._s(e.item.payment))])]}}])},[a("template",{slot:"footer"},[a("tr",{staticClass:"gray"},[a("td",{attrs:{colspan:"2"}},[t._v("\n          Do sada uplaceno (bez avansa)\n        ")]),t._v(" "),a("td",{staticClass:"text-xs-center"},[t._v("\n          "+t._s(t.totalWithoutAvans)+"\n        ")])]),t._v(" "),a("tr",{staticClass:"gray"},[a("td",{attrs:{colspan:"2"}},[t._v("\n          Do sada uplaceno (sa avansom)\n        ")]),t._v(" "),a("td",{staticClass:"text-xs-center"},[t._v("\n          "+t._s(t.total)+"\n        ")])]),t._v(" "),a("tr",{staticClass:"gray"},[a("td",{attrs:{colspan:"2"}},[t._v("\n          Dug\n        ")]),t._v(" "),a("td",{staticClass:"text-xs-center"},[t._v("\n          "+t._s(t.rest)+"\n        ")])])])],2):t._e(),t._v(" "),a("v-form",{ref:"paymentForm",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[0==this.rest||t.plan.status?t._e():a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-text-field",{attrs:{"prepend-icon":"event",label:"Datum Uplate",rules:t.paymentDateRules,mask:"##.##.####"},on:{blur:function(e){t.payment.paymentDate=t.parseDate(t.paymentDate)}},model:{value:t.paymentDate,callback:function(e){t.paymentDate=e},expression:"paymentDate"}})],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-md1":""}},[a("v-text-field",{attrs:{prefix:"€",rules:t.amountRule,label:"Kolicina uplate",transition:"slide-y-transition"},on:{change:t.limitInput},model:{value:t.payment.payment,callback:function(e){t.$set(t.payment,"payment",e)},expression:"payment.payment"}})],1)],1)],1)],1)},staticRenderFns:[]};var et=a("VU/8")(Q,tt,!1,function(t){a("BrRV")},null,null).exports,at={name:"PlanList",components:{payment:et},asyncComputed:{plans:{get:function(){var t=this;return this.api.getPlans().then(function(e){return t.progress=!1,e.data=e.data.map(function(t){return t.dateCreatedSorting=new Date(t.createdAt).getSeconds(),t}),null!==e.data?e.data:[]})},watch:function(){this.updatePlans}}},data:function(){return{progress:!0,planPayment:new J,payment:null,paymentModal:!1,planDeleteId:null,conformationDialog:!1,api:new C,headers:[{text:"Kupac",align:"left",sortable:!0,value:"Client.ime"},{text:"Kupljeno",value:"createdAt",sortable:!0},{text:"Status",value:"status",align:"center",sortable:!1},{text:"Prodato",align:"center"},{text:"Avans",value:"avanas"},{text:"Ukupna Cena",value:"cena"},{text:"Rok Uplate",value:"rokUplate"},{text:"",sortable:!1},{text:"Akcije",sortable:!1}],previewShow:!1,documentId:0,currentPlanId:0,currentPrice:0,updatePlans:!1}},computed:{isPlanPayed:function(){var t=this;return 0==this.planPayment.id||this.plans.find(function(e){return e.id==t.planPayment.id}).status}},methods:{getPlanWithId:function(t){var e=this.plans.find(function(e){return e.id==t});return new J(e.id,e.clientId,e.neto,e.status,e.rokUplate,e.avans,e.napomena)},formatISODate:function(t){return null==t?"-":I()(t,I.a.ISO_8601).format("DD MMM YYYY")},deleteItem:function(t){this.planPayment=new J,this.conformationDialog=!0,this.planDeleteId=t.id},openPaymentDialog:function(t){this.payment=new X,this.planPayment=this.getPlanWithId(t),this.paymentModal=!0},soldServices:function(t){var e=t.Tickets.length>0?t.Tickets[0].PassangersTickets.length+" Karti":"";return e+=t.Arrangements.length>0?t.Arrangements.length+" Aranžmana":""},makePayment:function(){var t=this;return v()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.payment.paymentValid){e.next=11;break}return e.prev=1,e.next=4,t.api.makePayment(t.planPayment.id,t.payment);case 4:void 0!==(a=e.sent).data&&(t.payment=new X,t.updatePlans=new Date,t.planPayment=t.getPlanWithId(a.data.PlanId),t.$refs.payment.resetValidation()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),w.error(e.t0.message);case 11:case"end":return e.stop()}},e,t,[[1,8]])}))()},editItem:function(t){t.Tickets.length>0?Ne.push({path:"/dashboard/"+t.Tickets[0].type+"-tickets-store/"+t.id}):Ne.push({path:"/dashboard/arrangment-store/"+t.id})},deletePlan:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.deletePlansById(t.planDeleteId);case 3:t.conformationDialog=!1,t.updatePlans=new Date,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),w.error("Neuspesno brisanje kupovine "+e.t0);case 10:case"end":return e.stop()}},e,t,[[0,7]])}))()},deletePayment:function(t){var e=this;return v()(l.a.mark(function a(){var n;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.api.deletePayment(t);case 2:void 0!==(n=a.sent).data&&(e.payment=new X,e.updatePlans=new Date,e.planPayment=e.getPlanWithId(n.data.id),e.$refs.payment.resetValidation());case 4:case"end":return a.stop()}},a,e)}))()}}},nt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{"align-center":"",row:""}},[a("v-flex",[a("v-toolbar",{staticClass:"elevation-1",attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[t._v("Poslednje prodaje")]),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),a("v-spacer"),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.conformationDialog,callback:function(e){t.conformationDialog=e},expression:"conformationDialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Upozorenje")])]),t._v(" "),a("v-card-text",[a("p",[t._v("Da li zelite izbrisati prodaju ?")])]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.conformationDialog=!1}}},[t._v("Odustani")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deletePlan(e)}}},[t._v("Nastavi")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.paymentModal,callback:function(e){t.paymentModal=e},expression:"paymentModal"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Uplate")])]),t._v(" "),null!=t.payment?a("payment",{ref:"payment",attrs:{payment:t.payment,plan:t.planPayment},on:{deletePayment:t.deletePayment}}):t._e(),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.paymentModal=!1}}},[t._v("Zatvori")]),t._v(" "),t.isPlanPayed?t._e():a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.makePayment(e)}}},[t._v("Izvrsi Uplatu")])],1)],1)],1)],1),t._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:null==t.plans?[]:t.plans,loading:null==t.plans,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("td",{staticClass:"text-xs-left relative"},[a("span",{staticClass:"indicator"}),t._v(" "),a("v-avatar",{attrs:{size:"25px",tile:""}},[a("img",{attrs:{src:e.item.Client.urlSlike,alt:"Customer Avatar"}})]),t._v("\n        "+t._s(e.item.Client.ime+" "+e.item.Client.prezime)+"\n      ")],1),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(t.formatISODate(e.item.createdAt)))]),t._v(" "),e.item.status?a("td",{staticClass:"text-xs-center"},[a("v-chip",{attrs:{color:"green","text-color":"white"}},[t._v("Isplaćeno")])],1):t._e(),t._v(" "),e.item.status?t._e():a("td",{staticClass:"text-xs-center"},[a("v-chip",{attrs:{color:"red","text-color":"white"}},[t._v("Neisplaćeno")])],1),t._v(" "),a("td",{staticClass:"text-xs-center"},[t._v(t._s(t.soldServices(e.item)))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.avans>0?e.item.avans:"-"))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.neto))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(t.formatISODate(e.item.rokUplate)))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[a("v-btn",{attrs:{slot:"activator",depressed:"",small:"",color:"primary"},on:{click:function(a){t.openPaymentDialog(e.item.id)}},slot:"activator"},[t._v("Uplate")])],1),t._v(" "),a("td",{staticClass:"justify-center layout px-0"},[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(a){t.editItem(e.item)}}},[t._v("\n          edit\n        ")]),t._v(" "),a("v-icon",{attrs:{small:""},on:{click:function(a){t.deleteItem(e.item)}}},[t._v("\n          delete\n        ")])],1)]}}])},[a("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)],1)},staticRenderFns:[]};var st=a("VU/8")(at,nt,!1,function(t){a("24Rw")},null,null).exports,rt=a("bOdI"),it=a.n(rt),ot={name:"User",props:{user:{type:Object}},data:function(){return{valid:!1,show:!1,nameRules:[function(t){return!!t||"Ime Musterije je obavezan podatak"}],surnameRules:[function(t){return!!t||"Prezime Musterije je obavezan podatak"}],usernameRules:[function(t){return!!t||"Korisnicko ime je obavezan podatak"}],passwordRules:[function(t){return!!t||"Sifra je obavezan podatak"}],api:new C}},asyncComputed:{userRolesPicklist:function(){var t=this;return v()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.getPicklist("role");case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,t)}))()}},computed:{isValid:function(){return this.$refs.userForm.validate()}},methods:{},watch:{},mounted:function(){}},lt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-form",{ref:"userForm",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-text-field",{attrs:{rules:t.nameRules,label:"Ime",required:""},model:{value:t.user.name,callback:function(e){t.$set(t.user,"name",e)},expression:"user.name"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-text-field",{attrs:{rules:t.surnameRules,label:"Prezime",required:""},model:{value:t.user.surname,callback:function(e){t.$set(t.user,"surname",e)},expression:"user.surname"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-text-field",{attrs:{label:"E-Mail",transition:"slide-y-transition"},model:{value:t.user.email,callback:function(e){t.$set(t.user,"email",e)},expression:"user.email"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-text-field",{attrs:{"append-icon":t.show?"visibility_off":"visibility",rules:t.passwordRules,type:t.show?"text":"password",label:"Sifra",transition:"slide-y-transition"},on:{"click:append":function(e){t.show=!t.show}},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-text-field",{attrs:{label:"Korisnicko Ime",rules:t.usernameRules,transition:"slide-y-transition"},model:{value:t.user.username,callback:function(e){t.$set(t.user,"username",e)},expression:"user.username"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-select",{attrs:{items:t.userRolesPicklist,"item-text":"title","item-value":"value",label:"Permisije"},model:{value:t.user.role,callback:function(e){t.$set(t.user,"role",e)},expression:"user.role"}})],1)],1)],1)},staticRenderFns:[]};var ct={name:"UsersList",data:function(){var t;return t={conformationDialog:!1,user:new g},it()(t,"conformationDialog",!1),it()(t,"updateUsers",0),it()(t,"dialog",!1),it()(t,"api",new C),it()(t,"headers",[{text:"Ime",align:"left",sortable:!1,value:"name"},{text:"Przime",align:"left",sortable:!1,value:"surname"},{text:"Korisnicko Ime",value:"username"},{text:"E-mail",value:"email"},{text:"Akcije",value:"role",align:"center"}]),it()(t,"editedIndex",-1),t},components:{user:a("VU/8")(ot,lt,!1,function(t){a("jMqY")},null,null).exports},asyncComputed:{users:{get:function(){return this.api.getAllUsers().then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateUsers}}},watch:{},methods:{parseDate:function(t){return I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()},close:function(){this.conformationDialog=!1},editItem:function(t){this.user=t,this.dialog=!0},deleteItem:function(t){this.user=t,this.conformationDialog=!0},newUserInstance:function(){this.user=new g},saveUser:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.user.isValid){e.next=12;break}return e.prev=1,e.next=4,t.api.addUser(t.user);case 4:e.sent,t.updateUsers=new Date,t.dialog=!1,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),toast.error(e.t0.toString());case 12:case"end":return e.stop()}},e,t,[[1,9]])}))()},deleteUser:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.deleteUser(t.user.id);case 3:e.sent,t.updateUsers=new Date,t.user=new g,t.conformationDialog=!1,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),toast.error(e.t0.toString());case 12:case"end":return e.stop()}},e,t,[[0,9]])}))()}},mounted:function(){}},ut={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{"align-center":"",row:""}},[a("v-flex",[a("v-toolbar",{staticClass:"elevation-1",attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[t._v("Radnici")]),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),a("v-spacer"),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-btn",{staticClass:"mb-2",attrs:{slot:"activator",color:"primary",dark:""},on:{click:function(e){t.newUserInstance()}},slot:"activator"},[a("v-icon",[t._v(t._s("person_add"))]),t._v(" Dodaj Korisnika\n        ")],1),t._v(" "),a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Dodaj Korisnika")])]),t._v(" "),a("v-card-text",[a("user",{ref:"user",attrs:{user:t.user}})],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.dialog=!1}}},[t._v("Odustani")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.saveUser(e)}}},[t._v(t._s(null!=t.user.id?"Izmeni Korisnika":"Dodaj Korisnika"))])],1)],1)],1)],1),t._v(" "),t.users?a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.users,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("td",{staticClass:"text-xs-left"},[a("v-avatar",{attrs:{size:"25px",tile:""}},[a("img",{attrs:{src:e.item.imageUrl,alt:"Customer Avatar"}})]),t._v("\n          "+t._s(e.item.name)+"\n        ")],1),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v("\n          "+t._s(e.item.surname)+"\n        ")]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.username))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.email))]),t._v(" "),a("td",{staticClass:"justify-center layout px-0"},[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(a){t.editItem(e.item)}}},[t._v("\n            edit\n          ")]),t._v(" "),a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(a){t.deleteItem(e.item)}}},[t._v("\n            delete\n          ")])],1)]}}])}):t._e()],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.conformationDialog,callback:function(e){t.conformationDialog=e},expression:"conformationDialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Upozorenje")])]),t._v(" "),a("v-card-text",[a("p",[t._v("Da li zelite izbrisati ovog Korisnika ?")])]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.conformationDialog=!1}}},[t._v("Odustani")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deleteUser()}}},[t._v("Nastavi")])],1)],1)],1)],1)},staticRenderFns:[]};var dt=a("VU/8")(ct,ut,!1,function(t){a("dZyw")},null,null).exports,vt=a("M4fF"),pt=a.n(vt),mt=function t(e,a,n,s,r,i,o,l,c,u,d){m()(this,t),this.id=null,this.putovanjeOd=n||null,this.putovanjeDo=s||null,this.jedanParvac=r||!1,this.datumPolaska=i||null,this.datumDolaska=o||null,this.avioKompanija=l||null,this.potvrdjeno=c||!1,this.datumRezervacije=u||null,this.ClientId=a||0,this.PlanId=d||0,this.putovanjeOdObj=null,this.putovanjeDoObj=null,this.avioKompanijaObj={},this.type=e},gt={name:"TicketsDetails",props:{ticket:{type:Object,default:function(){return new mt}}},components:{payment:et},data:function(){return{valid:!1,payment:new X,api:new C}},computed:{isPlanPayed:function(){return this.ticket.Plan.status}},methods:{parseDate:function(t){t=I()(t,I.a.ISO_8601).format("DD.MM.YYYY");return I()(t,"DD.MM.YYYY").isValid()?t:"-"},makePayment:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.payment.paymentValid){e.next=11;break}return e.prev=1,e.next=4,t.api.makePayment(t.ticket.Plan.id,t.payment);case 4:void 0!==e.sent.data&&(t.payment=new X,t.$emit("restartTicket",t.ticket.id),t.$refs.payment.resetValidation()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),w.error(e.t0.message);case 11:case"end":return e.stop()}},e,t,[[1,8]])}))()},deletePayment:function(t){var e=this;return v()(l.a.mark(function a(){return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.api.deletePayment(t);case 3:void 0!==a.sent.data&&(e.payment=new X,e.$emit("restartTicket",e.ticket.id),e.$refs.payment.resetValidation()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),w.error(a.t0.message);case 10:case"end":return a.stop()}},a,e,[[0,7]])}))()}}},ft={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-layout",[void 0!==t.ticket.Client?a("v-flex",{attrs:{md6:""}},[a("h3",{staticStyle:{"text-decoration":"underline"}},[t._v("Nosilac Putovanja")]),t._v(" "),a("table",{staticStyle:{"list-style-type":"none",padding:"0",width:"100%"}},[a("tr",[a("td",[t._v("\n              Ime Prezime:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.ticket.Client.ime+" "+t.ticket.Client.prezime))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Broj Telefona:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.ticket.Client.brojTelefona))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Email: \n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.ticket.Client.email))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Broj Pasosa:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.ticket.Client.brojPasosa))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Datum Rodjenja:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.ticket.Client.datumRodjenja))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Struka:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.ticket.Client.struka))])])])])]):t._e(),t._v(" "),void 0!==t.ticket.Client?a("v-flex",{attrs:{md6:""}},[a("h3",{staticStyle:{"text-decoration":"underline"}},[t._v("Karta")]),t._v(" "),a("table",{staticStyle:{"list-style-type":"none",padding:"0",width:"100%"}},[a("tr",[a("td",[t._v("\n              Destinacija:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(void 0!=t.ticket.Destination?t.ticket.Destination.destinacija:t.ticket.putovanjeDoObj.description))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Datum polaska / povratka:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.parseDate(t.ticket.datumPolaska)+" - "+t.parseDate(t.ticket.datumDolaska)))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Agencija:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(void 0!=t.ticket.Company?t.ticket.Company.name:t.ticket.avioKompanija))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Putovanje:\n            ")]),t._v(" "),a("td",[a("strong",[t._v("\n                "+t._s(void 0!=t.ticket.Destination?t.ticket.Destination.destinacija:t.ticket.putovanjeDoObj.description)+" -\n                "+t._s(void 0!=t.ticket.Arrival?t.ticket.Arrival.destinacija:t.ticket.putovanjeOdObj.description)+"\n              ")])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Broj Putnika: \n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(void 0!=t.ticket.PassangersTickets?t.ticket.PassangersTickets.length+1:t.ticket.numberOfPassangers))])])]),t._v(" "),void 0!=t.ticket.Plan?a("tr",[a("td",[t._v("\n              Status: \n            ")]),t._v(" "),a("td",[a("v-chip",{attrs:{color:t.ticket.Plan.status?"green":"red","text-color":"white"}},[t._v(t._s(t.ticket.Plan.status?"Isplaćeno":"Neisplaćeno"))])],1)]):t._e(),t._v(" "),void 0!=t.ticket.Plan?a("tr",[a("td",[t._v("\n              Avans: \n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.ticket.Plan.avans))])])]):t._e(),t._v(" "),void 0!=t.ticket.Plan?a("tr",[a("td",[t._v("\n              Neto: \n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.ticket.Plan.neto))])])]):t._e(),t._v(" "),void 0!=t.ticket.Plan?a("tr",[a("td",[t._v("\n              Bruto: \n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.ticket.Plan.bruto))])])]):t._e()])]):t._e()],1),t._v(" "),void 0!==t.ticket.Plan?a("v-layout",{attrs:{column:""}},[a("v-flex",[null!=t.ticket.Plan.avans?a("payment",{ref:"payment",attrs:{plan:t.ticket.Plan,payment:t.payment},on:{deletePayment:t.deletePayment}}):t._e()],1),t._v(" "),a("v-flex",{staticClass:"text-right"},[t.isPlanPayed?t._e():a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.makePayment(e)}}},[t._v("Izvrsi Uplatu")])],1)],1):t._e()],1)},staticRenderFns:[]};var ht=a("VU/8")(gt,ft,!1,function(t){a("IK0C")},null,null).exports,kt={name:"TicketsList",components:{"ticket-detail":ht},props:{ticketsProps:{type:Array,default:function(){return[]}},statistics:{type:Boolean,default:!1}},data:function(){return{ticketDetail:new mt,detailModal:!1,conformationDialog:!1,updateTickets:0,dialog:!1,api:new C,headers:[{text:"Kupac",align:"left",sortable:!0,value:"Client.ime"},{text:"Broj Putnika",value:"Broj Putnika"},{text:"Putovanje Od",align:"left",sortable:!0,value:"putovanjeOd"},{text:"Putovanje Do",align:"left",sortable:!0,value:"putovanjeDo"},{text:"Datum Polaska",value:"datumPolaska"},{text:"Datum Povratka",value:"Datum Povratka"},{text:"Datum Rezervacije",align:"center",value:"datumRezervacije"},{text:"-"},{text:"--"},{text:"",sortable:!1}],editedIndex:-1}},asyncComputed:{tickets:{get:function(){return this.ticketsProps.length>0?this.ticketsProps:this.statistics?[]:this.api.getTickets(this.$route.params.type).then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateTickets}}},watch:{},computed:{getHeader:function(){return void 0!==this.$route.params.type?"bus"==this.$route.params.type?"Bus Karte":"Avio Karte":"Karte"}},methods:{updateChanges:function(t){this.updateTickets=new Date,this.ticketDetail=this.ticketDetail.find(function(e){return e.id==t})},parseDate:function(t){t=I()(t,I.a.ISO_8601).format("DD.MM.YYYY");return I()(t,"DD.MM.YYYY").isValid()?t:"-"},close:function(){this.conformationDialog=!1},editItem:function(t){Ne.push({path:"/dashboard/"+this.$route.params.type+"-tickets-store/"+t.PlanId})},openDetails:function(t,e){"DIV"!==t.toElement.tagName&&(this.detailModal=!0,this.ticketDetail=e)},addTransfer:function(t){},generateBill:function(t){},removeChecked:function(t){var e=this;return v()(l.a.mark(function a(){var n;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.api.uncheckTicket(t);case 3:n=a.sent,w.success(n.data.message),e.updateTickets=new Date,a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),w.error(a.t0.toString());case 11:case"end":return a.stop()}},a,e,[[0,8]])}))()},checkTicket:function(t){var e=this;return v()(l.a.mark(function a(){var n;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.api.checkTicket(t);case 3:n=a.sent,w.success(n.data.message),e.updateTickets=new Date,a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),w.error(a.t0.toString());case 11:case"end":return a.stop()}},a,e,[[0,8]])}))()}},mounted:function(){}},_t={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{"align-center":"",row:""}},[a("v-flex",[a("v-toolbar",{staticClass:"elevation-1",attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[t._v(t._s(t.getHeader))]),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),a("v-spacer")],1),t._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:null==t.tickets?[]:t.tickets,loading:null==t.tickets,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",{on:{click:function(a){t.openDetails(a,e.item)}}},[a("td",{staticClass:"text-xs-left relative"},[a("span",{staticClass:"indicator"}),t._v("\n            "+t._s(e.item.Client.ime+" "+e.item.Client.prezime)+"\n          ")]),t._v(" "),a("td",{staticClass:"text-xs-left"},[a("v-icon",{attrs:{small:""}},[t._v("\n              "+t._s("bus"==e.item.type?"airport_shuttle":"flight")+"\n            ")]),t._v("\n            "+t._s(e.item.PassangersTickets.length)+" "+t._s(e.item.PassangersTickets.length>1?" Putnika":"Putnik"))],1),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v("\n            "+t._s(e.item.putovanjeOd)+"\n          ")]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v("\n            "+t._s(e.item.putovanjeDo)+"\n          ")]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(t.parseDate(e.item.datumPolaska)))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(t.parseDate(e.item.datumDolaska)))]),t._v(" "),a("td",{staticClass:"text-xs-center"},[t._v(t._s(t.parseDate(e.item.datumRezervacije)))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[e.item.potvrdjeno?a("v-chip",{attrs:{color:"green","text-color":"white",close:""},on:{input:function(a){t.removeChecked(e.item.id)}},model:{value:e.item.potvrdjeno,callback:function(a){t.$set(e.item,"potvrdjeno",a)},expression:"props.item.potvrdjeno"}},[t._v("Potvrdjeno")]):t._e()],1),t._v(" "),a("td",{staticClass:"text-xs-left"},[a("v-menu",{attrs:{"offset-y":""}},[a("v-btn",{attrs:{slot:"activator",color:"blue",dark:""},slot:"activator"},[t._v("\n                Akcije\n              ")]),t._v(" "),a("v-list",[e.item.potvrdjeno?t._e():a("v-list-tile",{on:{click:function(a){a.preventDefault(),t.checkTicket(e.item.id)}}},[a("v-list-tile-title",[t._v("Potvrdi Kartu")])],1)],1)],1)],1),t._v(" "),a("td",{staticClass:"justify-center layout px-0"},[a("v-btn",{attrs:{icon:""},on:{click:function(a){t.editItem(e.item)}}},[a("v-icon",{attrs:{small:""}},[t._v("\n              edit\n              ")])],1)],1)])]}}])},[a("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"800px"},model:{value:t.detailModal,callback:function(e){t.detailModal=e},expression:"detailModal"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Detalji")])]),t._v(" "),a("ticket-detail",{attrs:{ticket:t.ticketDetail},on:{restartTicket:t.updateChanges}}),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.detailModal=!1}}},[t._v("Zatvori")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var bt=a("VU/8")(kt,_t,!1,function(t){a("95uG")},null,null).exports,xt=function t(e,a,n,s,r,i,o,l,c,u,d,v,p,g,f){m()(this,t),this.id=null,this.destinacija=e||null,this.hotel=a||null,this.hotelObj=null,this.agent=n||null,this.agentObj=null,this.rooms=[],this.passangers=[],this.roomDescription=null,this.ServiceId=s||null,this.datumPocetka=r||null,this.datumZavrsetka=i||null,this.usluznaKompanija=o||null,this.cena=l||null,this.brPutnika=c||null,this.brojDana=u||null,this.TypeId=d||null,this.ClientId=v||0,this.PlanId=p||0,this.mestoPolaska=g||null,this.mestoPolaskaObj=null,this.destinacijaObj=null},jt={name:"ArrangementDetails",props:{arrangement:{type:Object,default:function(){return new xt}}},components:{payment:et},data:function(){return{valid:!1,payment:new X,api:new C}},computed:{isPlanPayed:function(){return this.arrangement.Plan.status}},methods:{parseDate:function(t){t=I()(t,I.a.ISO_8601).format("DD.MM.YYYY");return I()(t,"DD.MM.YYYY").isValid()?t:"-"},makePayment:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.payment.paymentValid){e.next=11;break}return e.prev=1,e.next=4,t.api.makePayment(t.arrangement.Plan.id,t.payment);case 4:void 0!==e.sent.data&&(t.payment=new X,t.$emit("restartArrangement",t.arrangement.id),t.$refs.payment.resetValidation()),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),w.error(e.t0.message);case 11:case"end":return e.stop()}},e,t,[[1,8]])}))()},deletePayment:function(t){var e=this;return v()(l.a.mark(function a(){return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.api.deletePayment(t);case 3:void 0!==a.sent.data&&(e.payment=new X,e.$emit("restartArrangement",e.arrangement.id),e.$refs.payment.resetValidation()),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),w.error(a.t0.message);case 10:case"end":return a.stop()}},a,e,[[0,7]])}))()}}},yt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-layout",[void 0!==t.arrangement.Client?a("v-flex",{attrs:{md6:""}},[a("h3",{staticStyle:{"text-decoration":"underline"}},[t._v("Nosilac Putovanja")]),t._v(" "),a("table",{staticStyle:{"list-style-type":"none",padding:"0",width:"100%"}},[a("tr",[a("td",[t._v("\n              Ime Prezime:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.arrangement.Client.ime+" "+t.arrangement.Client.prezime))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Broj Telefona:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.arrangement.Client.brojTelefona))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Email: \n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.arrangement.Client.email))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Broj Pasosa:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.arrangement.Client.brojPasosa))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Datum Rodjenja:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.arrangement.Client.datumRodjenja))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Struka:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.arrangement.Client.struka))])])])])]):t._e(),t._v(" "),void 0!==t.arrangement.Client?a("v-flex",{attrs:{md6:""}},[a("h3",{staticStyle:{"text-decoration":"underline"}},[t._v("Aranžman")]),t._v(" "),a("table",{staticStyle:{"list-style-type":"none",padding:"0",width:"100%"}},[a("tr",[a("td",[t._v("\n              Destinacija:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(void 0!=t.arrangement.Destination?t.arrangement.Destinacija.destinacija:t.arrangement.destinacijaObj.description))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Hotel:\n            ")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("\n              Trajanje:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.parseDate(t.arrangement.datumPocetka)+" - "+t.parseDate(t.arrangement.datumZavrsetka)))]),t._v(" "),a("span",{staticClass:"grey--text"},[t._v("("+t._s(t.arrangement.brojDana)+" Noćenja)")])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Usluga:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(void 0!=t.arrangement.Service?t.arrangement.Service.title:t.arrangement.serviceText))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Tip Anranžmana:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(void 0!=t.arrangement.Type?t.arrangement.Type.title:t.arrangement.arrangementTypeText))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Agent:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(void 0!=t.arrangement.Agent?t.arrangement.Agent.name:t.arrangement.searchAgent))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Mesto Polaska:\n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.arrangement.mestoPolaska))])])]),t._v(" "),a("tr",[a("td",[t._v("\n              Broj Putnika: \n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(void 0!=t.arrangement.PassangersArrangements?t.arrangement.PassangersArrangements.length+1:t.arrangement.numberOfPassangers))])])]),t._v(" "),void 0!=t.arrangement.Plan?a("tr",[a("td",[t._v("\n              Status: \n            ")]),t._v(" "),a("td",[a("v-chip",{attrs:{color:t.arrangement.Plan.status?"green":"red","text-color":"white"}},[t._v(t._s(t.arrangement.Plan.status?"Isplaćeno":"Neisplaćeno"))])],1)]):t._e(),t._v(" "),void 0!=t.arrangement.Plan?a("tr",[a("td",[t._v("\n              Avans: \n            ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.arrangement.Plan.avans))])])]):t._e()])]):t._e()],1),t._v(" "),void 0!==t.arrangement.Plan?a("v-layout",{attrs:{column:""}},[a("v-flex",[a("payment",{ref:"payment",attrs:{plan:t.arrangement.Plan,payment:t.payment},on:{deletePayment:t.deletePayment}})],1),t._v(" "),a("v-flex",{staticClass:"text-right"},[t.isPlanPayed?t._e():a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.makePayment(e)}}},[t._v("Izvrsi Uplatu")])],1)],1):t._e()],1)},staticRenderFns:[]};var wt=a("VU/8")(jt,yt,!1,function(t){a("UWks")},null,null).exports,Dt=a("2mH5"),Pt=a.n(Dt),Ct={name:"PieChart",components:{VueHighcharts:Pt.a},props:{data:{type:Object,default:function(){return{title:"No Title",subtitle:"No Subtitle",type:"No Type:",series:[["No Series",1]]}}}},data:function(){return{options:{chart:{type:"pie",options3d:{enabled:!0,alpha:45}},title:{text:this.data.title},subtitle:{text:this.data.subtitle},plotOptions:{pie:{innerSize:100,depth:45}},series:[{name:this.data.type,data:this.data.series}]}}}},St={render:function(){var t=this.$createElement;return(this._self._c||t)("vue-highcharts",{attrs:{options:this.options}})},staticRenderFns:[]};var At=a("VU/8")(Ct,St,!1,function(t){a("pTBM")},null,null).exports,Mt={name:"DestinationsDetails",props:{destinations:{type:Array,default:function(){return[]}}},components:{"pie-chart":At},data:function(){return{headers:[{text:"Destinacija",align:"left",sortable:!0,value:"destinacija"}],destinationOptions:{title:"Destinacije Musterije",subtitle:"",type:"Destinacija posecena:",series:this.destinations.map(function(t){return[t.destinacija,t.count]})}}},methods:{callback:function(){console.log("triggered")}}},Ot={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",[a("v-flex",{attrs:{sm6:""}},[a("div",{attrs:{"align-center":""}},[a("v-toolbar",{staticClass:"elevation-1",attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[t._v("Destinacije")]),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),a("v-spacer")],1),t._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:null==t.destinations?[]:t.destinations,loading:null==t.destinations,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",[a("td",{staticClass:"text-xs-left"},[t._v("\n              "+t._s(e.item.destinacija)+"\n            ")])])]}}])},[a("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1)],1)]),t._v(" "),a("v-flex",{staticStyle:{height:"500px"},attrs:{sm6:""}},[a("pie-chart",{attrs:{data:t.destinationOptions}})],1)],1)},staticRenderFns:[]};var It=a("VU/8")(Mt,Ot,!1,function(t){a("qCRJ")},null,null).exports,zt=(a("WgY6"),a("lDdF")),Rt=a.n(zt),Tt={name:"ArrangementsList",props:{arrangementsProps:{type:Array,default:function(){return[]}},statistics:{type:Boolean,default:!1}},components:{"arrangement-detail":wt},data:function(){return{loadingMessage:"",showLoading:!1,arrangementDetail:new xt,detailModal:!1,conformationDialog:!1,updateArrangements:0,dialog:!1,api:new C,headers:[{text:"Kupac",align:"left",sortable:!1},{text:"Destinacija",align:"left",sortable:!1,value:"destinacija"},{text:"Broj putnika",value:"brojOsoba"},{text:"Datum pocetka",value:"datumPocetkaSortable"},{text:"Usluga",value:"Service"},{text:"Period",align:"center"},{text:"Mesto Polaska",value:"mestoPolaska"},{text:"Zarada",value:"zarada"},{text:"Dug",value:"dug"},{text:"",value:"name",sortable:!1,align:"center"}],editedIndex:-1}},asyncComputed:{arrangements:{get:function(){var t=this;return this.arrangementsProps.length>0?this.formatArrangements(this.arrangementsProps):this.statistics?[]:this.api.getArrangements().then(function(e){return e.data=t.formatArrangements(e.data),null!==e.data?e.data:[]})},watch:function(){this.updateArrangements}}},watch:{},methods:{formatArrangements:function(t){return t=t.map(function(t){return t.brojOsoba=t.PassangersArrangements.length,t.datumPocetkaSortable=new Date(I()(t.datumPocetka,I.a.ISO_8601)).getSeconds(),t.zarada=parseInt(t.Plan.neto)-parseInt(t.Plan.bruto),t.dug=parseInt(t.Plan.neto)-(parseInt(t.Plan.avans)+t.Plan.Payments.reduce(function(t,e){return t+=parseInt(e.payment)},0)),t})},updateChanges:function(t){this.updateArrangements=new Date,this.arrangementDetail=this.arrangements.find(function(e){return e.id==t}),console.log(this.arrangementDetail)},parseDate:function(t){return I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()},close:function(){this.conformationDialog=!1},editItem:function(t){Ne.push({path:"/dashboard/arrangment-store/"+t.PlanId})},openDetails:function(t,e){console.log(t.toElement.tagName),"TD"==t.toElement.tagName&&(this.detailModal=!0,this.arrangementDetail=e)},downloadMemorandum:function(t){var e=this;return v()(l.a.mark(function a(){var n,s,r;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e.showLoading=!0,e.loadingMessage="Preuzimanje dokumenta sa Google Drive",n=new h.a(function(a,n){e.api.downloadFile(t).then(function(t){a(t)}).catch(function(t){n(t)})}),a.next=6,n;case 6:s=a.sent,r=new Blob([s.data],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),Rt.a.saveAs(r,"second-chance.docx"),e.showLoading=!1,a.next=17;break;case 12:a.prev=12,a.t0=a.catch(0),console.error(a.t0),e.showLoading=!1,w.error({message:a.t0.toString()});case 17:case"end":return a.stop()}},a,e,[[0,12]])}))()},addTransfers:function(t){},generateMemorandum:function(t){var e=this;return v()(l.a.mark(function a(){return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e.showLoading=!0,e.loadingMessage="Generisanje dokumenta u Google Drive",a.next=5,e.api.generateMemorandum(t);case 5:a.sent,e.updateArrangements=new Date,e.showLoading=!1,a.next=14;break;case 10:a.prev=10,a.t0=a.catch(0),e.updateArrangements=new Date,w.error(a.t0.toString());case 14:case"end":return a.stop()}},a,e,[[0,10]])}))()},generateBill:function(t){}},mounted:function(){}},Yt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{"align-center":"",row:""}},[a("v-flex",[a("v-toolbar",{staticClass:"elevation-1",attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[t._v("Aranžmani")]),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),a("v-spacer")],1),t._v(" "),a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:null==t.arrangements?[]:t.arrangements,loading:null==t.arrangements,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("tr",{on:{click:function(a){t.openDetails(a,e.item)}}},[a("td",{staticClass:"text-xs-left relative"},[a("span",{staticClass:"indicator"}),t._v("\n            "+t._s(e.item.Client.prezime+", "+e.item.Client.ime)+"\n          ")]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v("\n            "+t._s(e.item.destinacija)+"\n          ")]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.brojOsoba)+" "+t._s(e.item.brojOsoba>1?" putnika":" putnik"))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(t.parseDate(e.item.datumPocetka)))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.Service.title))]),t._v(" "),a("td",{staticClass:"text-xs-center"},[t._v(t._s(t.parseDate(e.item.datumPocetka)+" - "+t.parseDate(e.item.datumZavrsetka)))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.mestoPolaska))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.zarada))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.dug))]),t._v(" "),a("td",{staticClass:"justify-center layout px-0"},[a("v-menu",{attrs:{"offset-y":""}},[a("v-btn",{attrs:{slot:"activator",color:"blue",dark:""},slot:"activator"},[t._v("\n                Akcije\n              ")]),t._v(" "),a("v-list",[null==e.item.MemorandumId?a("v-list-tile",{on:{click:function(a){t.generateMemorandum(e.item.Plan.id)}}},[a("v-list-tile-title",[t._v("Generisi Memorandum")])],1):t._e()],1)],1),t._v(" "),a("v-btn",{attrs:{icon:""},on:{click:function(a){t.editItem(e.item)}}},[a("v-icon",{attrs:{small:""}},[t._v("\n                edit\n              ")])],1),t._v(" "),null!=e.item.MemorandumId?a("v-menu",{attrs:{"offset-y":""}},[a("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[a("v-icon",{attrs:{small:""}},[t._v("\n                  cloud\n                ")])],1),t._v(" "),a("v-list",[a("v-list-tile",{on:{click:function(a){t.downloadMemorandum(e.item.MemorandumId)}}},[a("v-list-tile-title",[t._v("Download")])],1)],1)],1):t._e()],1)])]}}])},[a("v-progress-linear",{attrs:{slot:"progress",color:"blue",indeterminate:""},slot:"progress"})],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"800px"},model:{value:t.detailModal,callback:function(e){t.detailModal=e},expression:"detailModal"}},[a("v-card",[a("arrangement-detail",{attrs:{arrangement:t.arrangementDetail},on:{restartArrangement:t.updateChanges}}),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.detailModal=!1}}},[t._v("Zatvori")])],1)],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.showLoading,callback:function(e){t.showLoading=e},expression:"showLoading"}},[a("v-card",{attrs:{color:"blue darken-3"}},[a("v-card-text",{staticStyle:{color:"#fff"},attrs:{"text-center":""}},[t._v("\n        "+t._s(t.loadingMessage)+"\n        "),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},staticRenderFns:[]};var Ut=a("VU/8")(Tt,Yt,!1,function(t){a("2eV2")},null,null).exports,$t={name:"CustomerDetails",components:{"ticket-detail":ht,"arrangement-detail":wt,"tickets-list":bt,"arrangement-list":Ut,"destinations-details":It},props:{customer:{type:Object}},data:function(){return{arrangementDetailModal:!1,arrangementDetail:new xt,ticketDetail:new mt,detailModalTickets:!1,ticketsHeader:[{text:"Tip karte",value:"type"},{text:"Broj Putnika",value:"Broj Putnika"},{text:"Putovanje Od",align:"left",sortable:!0,value:"putovanjeOd"},{text:"Putovanje Do",align:"left",sortable:!0,value:"putovanjeDo"},{text:"Datum Polaska",value:"datumPolaska"},{text:"Datum Povratka",value:"Datum Povratka"},{text:"Datum Rezervacije",align:"center",value:"datumRezervacije"},{text:"-"},{text:"",value:"name",sortable:!1}],arrangementsHeader:[{text:"Destinacija",align:"left",sortable:!1,value:"destinacija"},{text:"Broj putnika",value:"brojOsoba"},{text:"Datum pocetka",value:"datumPocetkaSortable"},{text:"Usluga",value:"Service"},{text:"Period",align:"center"},{text:"Mesto Polaska",value:"mestoPolaska"},{text:"Zarada",value:"zarada"},{text:"Dug",value:"dug"},{text:"",value:"name",sortable:!1,align:"center"}]}},computed:{haveDept:function(){return!(this.customer.Tickets.reduce(function(t,e){return t&=e.Plan.status},!0)&this.customer.Arrangements.reduce(function(t,e){return t&=e.Plan.status},!0))},destinations:function(){var t=this.customer.Arrangements.map(function(t){return t.Destination.from="arrangement",t.Destination}),e=this.customer.Tickets.map(function(t){return t.Arrival.from="ticket",t.Arrival}),a=t.concat(e),n=pt.a.uniqBy(a,"google_id");return n=n.map(function(t){return t.count=a.filter(function(e){return e.google_id==t.google_id}).length,t})}},methods:{parseDate:function(t){return I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()},updateChanges:function(){this.$emit("updateChanges")},openDetailsArrangement:function(t,e){"DIV"!==t.toElement.tagName&&(this.arrangementDetailModal=!0,this.arrangementDetail=e)},openDetails:function(t,e){"DIV"!==t.toElement.tagName&&(this.detailModalTickets=!0,this.ticketDetail=e)}}},Lt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-expansion-panel-content",{key:t.customer.id},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"name-heading"},[t._v(t._s(t.customer.imePrezime)+" ")]),t._v(" "),t.haveDept?a("span",{staticClass:"danger-message"},[a("v-icon",{attrs:{small:"",color:"red"}},[t._v("\n        error\n      ")]),t._v("\n    Neplaceni dugovi\n    ")],1):t._e()]),t._v(" "),a("v-card",[a("v-card-text",[a("v-layout",{attrs:{row:""}},[a("v-flex",{attrs:{md12:""}},[a("h3",{staticStyle:{"text-decoration":"underline",width:"100%"}},[t._v("Podaci")]),t._v(" "),a("table",{staticStyle:{"list-style-type":"none",padding:"0",width:"100%"}},[a("tr",[a("td",[t._v("\n                Broj Telefona:\n              ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.customer.brojTelefona))])])]),t._v(" "),a("tr",[a("td",[t._v("\n                Email: \n              ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.customer.email))])])]),t._v(" "),a("tr",[a("td",[t._v("\n                Broj Pasosa:\n              ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.customer.brojPasosa))])])]),t._v(" "),a("tr",[a("td",[t._v("\n                Datum Rodjenja:\n              ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.customer.datumRodjenja))])])]),t._v(" "),a("tr",[a("td",[t._v("\n                Struka:\n              ")]),t._v(" "),a("td",[a("strong",[t._v(t._s(t.customer.struka))])])])]),t._v(" "),a("br")])],1),t._v(" "),a("v-layout",[a("tickets-list",{attrs:{ticketsProps:t.customer.Tickets,statistics:!0}})],1),t._v(" "),a("v-layout",{attrs:{"mt-3":""}},[a("arrangement-list",{attrs:{arrangementsProps:t.customer.Arrangements,statistics:!0}})],1),t._v(" "),a("v-layout",{attrs:{"mt-3":""}},[a("destinations-details",{attrs:{destinations:t.destinations}})],1)],1)],1)],1)},staticRenderFns:[]};var Nt=a("VU/8")($t,Lt,!1,function(t){a("Whph")},null,null).exports,Et=a("Gu7T"),Vt=a.n(Et),Ht={name:"DestinationStatistics",props:{destinations:{type:Array,default:function(){return[]}}},components:{"pie-chart":At},data:function(){var t=this;return{destinationOptions:{title:"Destinacije Musterije",subtitle:"",type:"Destinacija posecena:",series:this.destinations.filter(function(e){return t.getPassangers(e).length>0}).map(function(e){return[e.destinacija,t.getPassangers(e).length]})}}},computed:{totalNumberOfPassangers:function(){return null==this.destinations?0:this.destinations.reduce(function(t,e){return t+=e.Arrangements.reduce(function(t,e){return t+=e.PassangersArrangements.length},0),t+=e.Arrival.reduce(function(t,e){return t+=e.PassangersTickets.length},0)},0)},passangers:function(){if(null==this.destinations)return[];var t=this.destinations.reduce(function(t,e){var a,n;return(a=t.push).apply.apply(a,[t].concat(Vt()(e.Arrangements.map(function(t){return t.PassangersArrangements.map(function(t){return null!=t.Passanger?t.Passanger:t.ClientPassanger})})))),(n=t.push).apply.apply(n,[t].concat(Vt()(e.Arrival.map(function(t){return t.PassangersTickets.map(function(t){return null!=t.Passanger?t.Passanger:t.ClientPassanger})})))),t},[]);return t}},methods:{getPassangers:function(t){var e,a,n=[];return(e=n.push).apply.apply(e,[n].concat(Vt()(t.Arrangements.map(function(t){return t.PassangersArrangements.map(function(t){return null!=t.Passanger?t.Passanger:t.ClientPassanger})})))),(a=n.push).apply.apply(a,[n].concat(Vt()(t.Arrival.map(function(t){return t.PassangersTickets.map(function(t){return null!=t.Passanger?t.Passanger:t.ClientPassanger})})))),n},unique:function(t){return pt.a.uniqBy(t,"id")}}},Ft={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{"justify-center":"",row:"",wrap:""}},[a("v-flex",{staticClass:"text-center",attrs:{sm3:"","px-5":""}},[a("h1",[t._v("\n      "+t._s(t.totalNumberOfPassangers)+"\n    ")]),t._v(" "),a("small",[t._v(" Ukupan Broj Putovanja (ukljucuje i putnike koji vise puta putovali)")])]),t._v(" "),a("v-flex",{staticClass:"text-center",attrs:{sm3:"","px-5":""}},[a("h1",[t._v("\n      "+t._s(t.unique(t.passangers).length)+"\n    ")]),t._v(" "),a("small",[t._v(" Ukupan Broj osoba koje su putovale")])]),t._v(" "),a("v-flex",{staticClass:"text-center",attrs:{sm3:"","px-5":""}},[a("h1",[t._v("\n      "+t._s(t.totalNumberOfPassangers)+"\n    ")]),t._v(" "),a("small",[t._v(" Ukupan Broj putnika (ukljucuje i putnike koji vise puta putovali)")])]),t._v(" "),a("v-flex",{staticClass:"text-center",attrs:{sm3:"","px-5":""}},[a("h1",[t._v("\n      "+t._s(t.totalNumberOfPassangers)+"\n    ")]),t._v(" "),a("small",[t._v(" Ukupan Broj putnika (ukljucuje i putnike koji vise puta putovali)")])]),t._v(" "),a("v-flex",[a("div",[a("pie-chart",{attrs:{data:t.destinationOptions}})],1)]),t._v(" "),a("v-flex",{attrs:{sm12:""}},[a("v-expansion-panel",{attrs:{popout:""}},t._l(t.destinations,function(e){return t.getPassangers(e).length>0?a("v-expansion-panel-content",{key:e.id},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"name-heading"},[t._v(t._s(e.destinacija)+" ")]),t._v(" "),a("span",[t._v(t._s(t.getPassangers(e).length)+" Putnika")])]),t._v(" "),a("v-card")],1):t._e()})),t._v(" "),a("pre",[t._v(t._s(t.destinations))])],1)],1)},staticRenderFns:[]};var Kt=a("VU/8")(Ht,Ft,!1,function(t){a("ETPZ")},null,null).exports,Bt={name:"LineChart",components:{VueHighcharts:Pt.a},props:{data:{default:function(){return{title:"No Title",subtitle:"No Subtitle",type:"No Type:",series:[["No Series",1]]}}}},asyncComputed:{plans:{get:function(){var t=this;return this.api.getPlans().then(function(e){t.progress=!1;var a=e.data;a.length>0&&(a.map(function(e){var a=[],n=e.createdAt.toString();a.push(n),a.push(e.neto),t.incomeData.push(a),t.options.series[0].setData(t.incomeData)}),console.log(t.incomeData))})},watch:function(){this.updatePlans}}},data:function(){return{api:new C,incomeData:[],options:{chart:{type:"line",th:1},options3d:{enabled:!0,alpha:45},title:{text:"Prodaja"},subtitle:{text:"u toku godine"},plotOptions:{pie:{innerSize:100,depth:45}},yAxis:[{title:{text:"Prihod u eurima"}}],legend:{align:"left",verticalAlign:"top",borderWidth:0},series:[{name:"Prihod",data:[["2.5.2018",3200],["2.9.2018",1200],["4.9.2018",2200],["2.11.2018",6200]]}]}}}},qt={render:function(){var t=this.$createElement;return(this._self._c||t)("vue-highcharts",{attrs:{options:this.options}})},staticRenderFns:[]};var Zt={name:"Statistics",data:function(){return{lineChartOptions:{title:"Prodaja u toku godine",subtitle:"",xAxis:{tickInterval:6048e5,tickWidth:0,gridLineWidth:1},plotOptions:{series:{label:{connectorAllowed:!1},pointStart:2010}},type:""},active:0,api:new C,property:null,keyWord:"",updateCustomers:new Date,updateDestinations:new Date,searchProperties:[{title:"Ime i prezime",value:"imePrezime"}]}},components:{"customer-details":Nt,"destination-statistics":Kt,"line-chart":a("VU/8")(Bt,qt,!1,function(t){a("yikG")},null,null).exports},asyncComputed:{customers:{get:function(){return this.api.getCustomerStatistics().then(function(t){return t.data=t.data.map(function(t){return t.imePrezime=t.ime+" "+t.prezime,t}),null!==t.data?t.data:[]})},watch:function(){this.updateCustomers}},destinations:{get:function(){return this.api.getDestinationsStatistics().then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateDestinations}}},methods:{updateChanges:function(){this.updateCustomers=new Date}},computed:{customersFiltered:function(){var t=this;return null===this.customers?[]:this.customers.filter(function(e){return null===t.property||e[t.property].toString().includes(t.keyWord)})}}},Wt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-tabs",{attrs:{color:"white ","slider-color":"green"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("v-tab",{key:0,attrs:{color:"white"}},[t._v("\n      PUTNICI\n\n    ")]),t._v(" "),a("v-tab",{key:2,attrs:{color:"white"}},[t._v("\n      NOVAC\n\n    ")]),t._v(" "),a("v-tab-item",{key:0},[a("v-card",{attrs:{flat:""}},[a("v-card-text",[a("v-layout",{attrs:{"px-5":""}},[a("v-flex",{attrs:{xs12:"",md5:""}},[a("v-select",{attrs:{items:t.searchProperties,label:"Filtriraj po","item-value":"value","item-text":"title"},model:{value:t.property,callback:function(e){t.property=e},expression:"property"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:"",md6:"","offset-md1":""}},[a("v-text-field",{attrs:{label:"Kljucna rec","prepend-icon":"search"},model:{value:t.keyWord,callback:function(e){t.keyWord=e},expression:"keyWord"}})],1)],1),t._v(" "),a("v-layout",[a("v-flex",{attrs:{xs12:"","mb-3":""}},[a("v-expansion-panel",{attrs:{popout:""}},t._l(t.customersFiltered,function(e,n){return a("customer-details",{key:n,attrs:{customer:e},on:{updateChanges:t.updateChanges}})}))],1)],1)],1)],1)],1),t._v(" "),a("v-tab-item",{key:2},[a("line-chart",{attrs:{data:t.lineChartOptions}})],1)],1)],1)},staticRenderFns:[]};var Gt={name:"Navigation",computed:{},data:function(){return{bottomNav:"prodaja",api:new C}},components:{statistics:a("VU/8")(Zt,Wt,!1,function(t){a("gBjA")},null,null).exports}},Jt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card",{attrs:{flat:""}},[a("v-tabs",{attrs:{centered:"",color:"white darken-3",light:"","icons-and-text":""}},[a("v-tabs-slider",{attrs:{color:"green"}}),t._v(" "),a("v-tab",{attrs:{href:"#tab-1"}},[t._v("\n      Prodaja\n      "),a("v-icon",{attrs:{color:"black"}},[t._v("attach_money")])],1),t._v(" "),a("v-tab",{attrs:{href:"#tab-2"}},[t._v("\n      Statistika\n      "),a("v-icon",{attrs:{color:"black"}},[t._v("cloud_circle")])],1),t._v(" "),a("v-tab-item",{attrs:{id:"tab-1"}},[a("v-card",{attrs:{flat:""}},[a("v-layout",{staticClass:"custom-padding",attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{md8:"",lg4:"","px-3":""}},[a("v-card",[a("v-card-media",{attrs:{src:"https://img.thedailybeast.com/image/upload/c_crop,d_placeholder_euli9k,h_1440,w_2560,x_0,y_0/dpr_2.0/c_limit,w_740/fl_lossy,q_auto/v1513972747/171220-irving-zunmun-aero-tease_yccsqq",height:"200px","max-height":"350px"}}),t._v(" "),a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("p",{staticClass:"headline mb-0 uppercase"},[t._v("Prodaja Avio Karti")])])]),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{dark:"",fab:"",color:"green",to:"/dashboard/tickets-store/flight"}},[a("v-icon",[t._v("add")])],1)],1)],1)],1),t._v(" "),a("v-flex",{attrs:{md7:"",lg4:"","px-3":""}},[a("v-card",[a("v-card-media",{attrs:{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSJxtAer9SqA4DfXK5c13YpLZJvA65sqDzaS2yg5ZTb1UQfqIVxpg",height:"200px"}}),t._v(" "),a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("p",{staticClass:"headline mb-0 uppercase"},[t._v("Prodaja Aranžmana")])])]),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{dark:"",fab:"",color:"green",to:"/dashboard/arrangment-store"}},[a("v-icon",[t._v("add")])],1)],1)],1)],1),t._v(" "),a("v-flex",{attrs:{md6:"",lg4:"","px-3":""}},[a("v-card",[a("v-card-media",{attrs:{src:"http://www.passengerplus.co.uk/images/5/bb7e64fyutong-cover-jpg.jpg",height:"200px"}}),t._v(" "),a("v-card-title",{attrs:{"primary-title":""}},[a("div",[a("p",{staticClass:"headline mb-0 uppercase"},[t._v("Prodaja Bus Karti")])])]),t._v(" "),a("v-card-actions",[a("v-btn",{attrs:{dark:"",fab:"",color:"green",to:"/dashboard/tickets-store/bus"}},[a("v-icon",[t._v("add")])],1)],1)],1)],1)],1)],1)],1),t._v(" "),a("v-tab-item",{attrs:{id:"tab-2"}},[a("statistics")],1)],1)],1)},staticRenderFns:[]};var Xt=a("VU/8")(Gt,Jt,!1,function(t){a("4Oz7")},null,null).exports,Qt={data:function(){return{dialog:!1,notifications:[{title:"Nema novih obaveštenja.."}],userOptions:[{icon:"lock",title:"Odjava",link:"Login"}],drawer:null,items:[{icon:"home",text:"Početna",link:"Navigation"},{icon:"contacts",text:"Mušterije",link:"CustomersList"},{icon:"history",text:"Poslednje Prodaje",link:"PlansList"},{icon:"keyboard_arrow_up","icon-alt":"keyboard_arrow_down",text:"Labels",model:!0,children:[{icon:"flight",text:"Avio Karte",link:"TicketsList",params:{type:"flight"}},{icon:"airport_shuttle",text:"Bus Karte",link:"TicketsList",params:{type:"bus"}},{icon:"beach_access",text:"Aranžmani",link:"ArrangementsList"}]},{icon:"person_add",text:"Dodaj Radnika",link:"UsersList"},{icon:"settings",text:"Podešavanja",link:"Settings"}]}},methods:{navigate:function(t){void 0!=t.params?Ne.push({name:t.link,params:t.params}):Ne.push({name:t.link})}},props:{source:String}},te={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{attrs:{id:"inspire"}},[a("v-navigation-drawer",{attrs:{clipped:t.$vuetify.breakpoint.lgAndUp,fixed:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("v-list",{attrs:{dense:""}},[t._l(t.items,function(e){return[e.heading?a("v-layout",{key:e.heading,attrs:{row:"","align-center":""}},[a("v-flex",{attrs:{xs6:""}},[e.heading?a("v-subheader",[t._v("\n              "+t._s(e.heading)+"\n            ")]):t._e()],1),t._v(" "),a("v-flex",{staticClass:"text-xs-center",attrs:{xs6:""}},[a("a",{staticClass:"body-2 black--text",attrs:{href:"#!"}},[t._v("EDIT")])])],1):e.children?a("v-list-group",{key:e.text,attrs:{"prepend-icon":e.model?e.icon:e["icon-alt"],"append-icon":""},model:{value:e.model,callback:function(a){t.$set(e,"model",a)},expression:"item.model"}},[a("v-list-tile",{attrs:{slot:"activator"},slot:"activator"},[a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n                "+t._s(e.text)+"\n              ")])],1)],1),t._v(" "),t._l(e.children,function(e,n){return a("v-list-tile",{key:n,on:{click:function(a){t.navigate(e)}}},[e.icon?a("v-list-tile-action",[a("v-icon",[t._v(t._s(e.icon))])],1):t._e(),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n                "+t._s(e.text)+"\n              ")])],1)],1)})],2):a("v-list-tile",{key:e.text,on:{click:function(a){t.navigate(e)}}},[a("v-list-tile-action",[a("v-icon",[t._v(t._s(e.icon))])],1),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[t._v("\n              "+t._s(e.text)+"\n            ")])],1)],1)]})],2)],1),t._v(" "),a("v-toolbar",{attrs:{"clipped-left":t.$vuetify.breakpoint.lgAndUp,color:"white",light:"",app:"",fixed:""}},[a("v-toolbar-title",{staticClass:"ml-0 pl-3",staticStyle:{width:"300px"}},[a("v-toolbar-side-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),t._v(" "),a("span",{staticClass:"hidden-sm-and-down"},[t._v("Ecco")])],1),t._v(" "),a("v-spacer"),t._v(" "),a("v-menu",{attrs:{"offset-y":""}},[a("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[a("v-icon",[t._v("notifications")])],1),t._v(" "),a("v-list",t._l(t.notifications,function(e,n){return a("v-list-tile",{key:n},[a("v-list-tile-title",[t._v(t._s(e.title))])],1)}))],1),t._v(" "),a("v-menu",{attrs:{"offset-y":""}},[a("v-btn",{attrs:{slot:"activator",icon:"",large:""},slot:"activator"},[a("v-avatar",{attrs:{size:"32px",tile:""}},[a("img",{attrs:{src:"https://i.imgur.com/BjP9MgO.png",alt:"Vuetify"}})])],1),t._v(" "),a("v-list",t._l(t.userOptions,function(e,n){return a("v-list-tile",{key:n,on:{click:function(a){t.navigate(e)}}},[a("v-list-tile-title",[t._v(t._s(e.title))])],1)}))],1)],1),t._v(" "),a("v-content",[a("v-container",{attrs:{fluid:"","align-start":""}},[a("router-view")],1)],1)],1)},staticRenderFns:[]},ee=a("VU/8")(Qt,te,!1,null,null,null).exports,ae=a("woOf"),ne=a.n(ae),se={name:"customer",props:{customer:{type:Object},isPassenger:{type:Boolean,default:!1},id:{default:0,type:Number}},data:function(){return{toolTip:!1,lock:!1,showDetails:!1,showMenu:!1,menu:!1,valid:!1,loading:!1,ime:"",nameRules:[function(t){return!!t||"Ime Musterije je obavezan podatak"}],surnameRules:[function(t){return!!t||"Prezime Musterije je obavezan podatak"}],birthDateRules:[function(t){return I()(t,"DD.MM.YYYY").isValid()||"Datum rodjenja nije validan, koristite format dan.mesec.godina"},function(t){return new Date(I()(t,"DD.MM.YYYY"))<new Date||"Datum rodjenja se ne nalazi u proslosti"}],moreDetails:!1,api:new C,urlslike:"",customerSuggestions:[],birthDate:null}},computed:{customerValid:function(){return this.$refs.customerForm.validate()},birthDateModel:function(){return this.customer.datumRodjenja},customerSearch:function(){return null===this.customer.ime?"":this.customer.ime}},methods:{emitNewInstance:function(){this.$emit("newCustomer")},addPassanger:function(){return this.customerValid?this.customer:(w.error("Podatci o Putniku nisu potpuni ili su pogresni"),!1)},saveCustomer:function(){var t=this;return v()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.customerValid){e.next=7;break}return e.next=3,t.api.saveCustomer(t.customer);case 3:return a=e.sent,e.abrupt("return",null!==a.data);case 7:w.error("Podatci o Musteriju nisu potpuni ili su pogresni");case 8:case"end":return e.stop()}},e,t)}))()},parseDate:function(t){return t?I()(t,"DD.MM.YYYY").format("YYYY-MM-DD"):null},setSuggestion:function(t){ne()(this.customer,t),this.showMenu=!1},upload:function(){document.getElementById("profile-picture").click()},uploadingPic:function(t){this.api.uploadPhoto(t).then(function(t){console.log(t.data.urlSlike),document.getElementById("slika").src=t.data.urlSlike}).catch(function(t){console.log(t)}),console.log(t.target.value),console.log("uploading")}},watch:{birthDateModel:function(t){this.birthDate=I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()},customerSearch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(""!==t&&t.length<10&&this.lock){var e=this;this.showMenu=!0,this.isPassenger?this.api.getSuggestedPassanger(t).then(function(t){e.customerSuggestions=t.data}).catch(function(t){console.log(t)}):this.api.getSuggestedCustomers(t).then(function(t){e.customerSuggestions=t.data}).catch(function(t){console.log(t)})}}},mounted:function(){}},re={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-form",{ref:"customerForm",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticStyle:{position:"relative !important"},attrs:{sm12:"",md5:""}},[a("v-menu",{staticClass:"elevation-0",attrs:{transition:"slide-y-transition","full-width":"",bottom:"","offset-y":""},model:{value:t.showMenu,callback:function(e){t.showMenu=e},expression:"showMenu"}},[a("v-text-field",{attrs:{slot:"activator",rules:t.nameRules,label:"Ime","clear-icon-cb":t.emitNewInstance,clearable:!t.isPassenger,readonly:null!=t.customer.id,hint:t.isPassenger||null==t.customer.id?"":"Da bi ste izmenili podatke kupca posetite Musterije Sekciju, u ovoj sekciji mozete samo promeniti musteriju ili staviti novu",required:""},on:{focus:function(e){t.lock=!0},blur:function(e){t.lock=!1}},slot:"activator",model:{value:t.customer.ime,callback:function(e){t.$set(t.customer,"ime",e)},expression:"customer.ime"}}),t._v(" "),t.customerSuggestions?a("v-list",{attrs:{transition:"slide-y-transition"}},t._l(t.customerSuggestions,function(e){return a("v-list-tile",{directives:[{name:"show",rawName:"v-show",value:t.customerSuggestions.length>0,expression:"customerSuggestions.length > 0"}],key:e.id,on:{click:function(a){t.setSuggestion(e)}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                "+t._s(e.ime.charAt(0))+"\n              ")]),t._v(" "),a("v-list-tile-title",[t._v(t._s(e.prezime+", "+e.ime))])],1)})):t._e()],1)],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-md1":""}},[a("v-text-field",{attrs:{rules:t.surnameRules,label:"Prezime","clear-icon-cb":t.emitNewInstance,clearable:!t.isPassenger,readonly:null!=t.customer.id,hint:t.isPassenger?"":"Da bi ste izmenili podatke kupca posetite Musterije Sekciju, u ovoj sekciji mozete samo promeniti musteriju ili staviti novu",required:""},model:{value:t.customer.prezime,callback:function(e){t.$set(t.customer,"prezime",e)},expression:"customer.prezime"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.showDetails,expression:"showDetails"}],attrs:{label:"Kontakt Telefon",transition:"slide-y-transition"},model:{value:t.customer.brojTelefona,callback:function(e){t.$set(t.customer,"brojTelefona",e)},expression:"customer.brojTelefona"}})],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-md1":""}},[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.showDetails,expression:"showDetails"}],attrs:{label:"E-Mail",transition:"slide-y-transition"},model:{value:t.customer.email,callback:function(e){t.$set(t.customer,"email",e)},expression:"customer.email"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.showDetails,expression:"showDetails"}],attrs:{"prepend-icon":"event",label:"Datum Rodjenja",rules:t.showDetails&null!==t.birthDate?t.birthDateRules:[],mask:"##.##.####"},on:{blur:function(e){t.customer.datumRodjenja=t.parseDate(t.birthDate)}},model:{value:t.birthDate,callback:function(e){t.birthDate=e},expression:"birthDate"}})],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-md1":""}},[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.showDetails,expression:"showDetails"}],attrs:{label:"Struka",transition:"slide-y-transition"},model:{value:t.customer.struka,callback:function(e){t.$set(t.customer,"struka",e)},expression:"customer.struka"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-text-field",{directives:[{name:"show",rawName:"v-show",value:t.showDetails,expression:"showDetails"}],attrs:{label:"Broj Pasosa",transition:"slide-y-transition"},model:{value:t.customer.brojPasosa,callback:function(e){t.$set(t.customer,"brojPasosa",e)},expression:"customer.brojPasosa"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-card-actions",[a("v-btn",{attrs:{flat:"",right:""},on:{click:function(e){t.showDetails=!t.showDetails}}},[t._v("\n            "+t._s(t.showDetails?"SAKRIJI DETALJE":"PRIKAZI DETALJE")+"\n            "),a("v-icon",[t._v(t._s(t.showDetails?"keyboard_arrow_up":"keyboard_arrow_down"))])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ie=a("VU/8")(se,re,!1,function(t){a("YL6M")},null,null).exports,oe=function t(e,a,n,s,r,i,o,l){m()(this,t),this.id=null,this.ime=e||null,this.prezime=a||null,this.putnik=!1,this.email=n||null,this.brojPasosa=s||null,this.brojTelefona=r||null,this.datumRodjenja=i||null,this.struka=o||null,this.adresa=l||null,this.brojRezervacije=null},le={components:{customer:ie},data:function(){return{customerDeleteId:null,conformationDialog:!1,updateCustomers:0,customer:new oe,dialog:!1,api:new C,headers:[{text:"Musterija",align:"left",sortable:!1,value:"name"},{text:"E-Mail",value:"email"},{text:"Broj Telefona",value:"brojTelefona"},{text:"Broj Pasosa",value:"brojPasosa"},{text:"Adresa",value:"adresa"},{text:"Struka",value:"adresa"},{text:"Actions",value:"name",sortable:!1}],editedIndex:-1}},asyncComputed:{customers:{get:function(){return this.api.getCustomers().then(function(t){return null!==t.data?t.data:[]})},watch:function(){this.updateCustomers}}},watch:{dialog:function(t){t||this.close()}},created:function(){},methods:{newCustomerInstance:function(){this.customer=new oe},editItem:function(t){this.customer=t,this.dialog=!0},deleteItem:function(t){this.conformationDialog=!0,this.customerDeleteId=t.id},deleteCustomer:function(){var t=this;return v()(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.api.deleteCustomer(t.customerDeleteId);case 3:void 0!==e.sent.data&&(t.conformationDialog=!1,t.updateCustomers=new Date),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),w.error("Pri brisanju Musterije");case 10:case"end":return e.stop()}},e,t,[[0,7]])}))()},close:function(){this.conformationDialog=!1},closeCustomerDialog:function(){this.dialog=!1},saveCustomer:function(){var t=this;return v()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$refs.form.saveCustomer();case 2:a=e.sent,t.dialog=!a,t.updateCustomers=new Date;case 5:case"end":return e.stop()}},e,t)}))()}},mounted:function(){}},ce={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{"align-center":"",row:""}},[a("v-flex",[a("v-toolbar",{staticClass:"elevation-1",attrs:{flat:"",color:"white"}},[a("v-toolbar-title",[t._v("Mušterije")]),t._v(" "),a("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),a("v-spacer"),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-btn",{staticClass:"mb-2",attrs:{slot:"activator",color:"primary",dark:""},on:{click:function(e){t.newCustomerInstance()}},slot:"activator"},[a("v-icon",[t._v(t._s("person_add"))]),t._v(" Dodaj Musteriju\r\n        ")],1),t._v(" "),a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Dodaj Musteriju")])]),t._v(" "),a("v-card-text",[a("customer",{ref:"form",attrs:{customer:t.customer}})],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.closeCustomerDialog(e)}}},[t._v("Cancel")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.saveCustomer(e)}}},[t._v("Save")])],1)],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.conformationDialog,callback:function(e){t.conformationDialog=e},expression:"conformationDialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Upozorenje")])]),t._v(" "),a("v-card-text",[a("p",[t._v("Da li zelite izbrisati korisnika ?")])]),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.close(e)}}},[t._v("Odustani")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){t.deleteCustomer(e)}}},[t._v("Nastavi")])],1)],1)],1)],1),t._v(" "),t.customers?a("v-data-table",{staticClass:"elevation-1",attrs:{headers:t.headers,items:t.customers,"hide-actions":""},scopedSlots:t._u([{key:"items",fn:function(e){return[a("td",{staticClass:"text-xs-left"},[a("v-avatar",{attrs:{size:"25px",tile:""}},[a("img",{attrs:{src:e.item.urlSlike,alt:"Customer Avatar"}})]),t._v("\r\n          "+t._s(e.item.prezime+", "+e.item.ime)+"\r\n        ")],1),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.email))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.brojTelefona))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.brojPasosa))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.adresa))]),t._v(" "),a("td",{staticClass:"text-xs-left"},[t._v(t._s(e.item.struka))]),t._v(" "),a("td",{staticClass:"justify-center layout px-0"},[a("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(a){t.editItem(e.item)}}},[t._v("\r\n            edit\r\n          ")]),t._v(" "),a("v-icon",{attrs:{small:""},on:{click:function(a){t.deleteItem(e.item)}}},[t._v("\r\n            delete\r\n          ")])],1)]}}])}):t._e()],1)],1)},staticRenderFns:[]};var ue=a("VU/8")(le,ce,!1,function(t){a("Sg4L")},null,null).exports,de=function t(e,a,n){m()(this,t),this.description=e||null,this.id=a||null,this.localId=n||null},ve=function t(e,a,n,s){m()(this,t),this.id=null,this.RoomContentId=a||null,this.RoomContent=null,this.RoomTypeId=n||null,this.RoomType=null,this.passangers=s||[],this.active=!1},pe={name:"Room",components:{customer:ie},props:{room:{type:Object},roomPassangers:{type:Array}},data:function(){return{api:new C,passanger:new oe,openPassangerForm:!1}},asyncComputed:{roomContents:function(){var t=this;return v()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.getPicklist("room-content");case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,t)}))()},roomTypes:function(){var t=this;return v()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.getPicklist("room-type");case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,t)}))()}},computed:{roomTypeAndStructureSelected:function(){return null!==this.room.roomType&&null!==this.room.roomContents},canSaveRoom:function(){return!this.openPassangerForm&&this.roomTypeAndStructureSelected&&this.room.passangers.length>0},passangerIsCreated:function(){return void 0===this.$store.getters.getCurentPassengerId||0===this.$store.getters.getCurentPassengerId}},methods:{handleContents:function(t){this.room.RoomContentId=t.id},handleTypes:function(t){this.room.RoomTypeId=t.id},validateRoom:function(){return console.log(this.room),!!(this.$refs.roomForm.validate()&&this.room.passangers.length>0)||(w.error("Podatci o sobi nisu potpuni"),!1)},addPassanger:function(){var t=this.$refs.passanger.addPassanger();!1!==t&&(this.room.passangers.push(t),this.passanger=new oe)},removePassanger:function(t){this.room.passangers=this.room.passangers.filter(function(e,a){return a!==t})}},beforeMount:function(){}},me={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-form",{ref:"roomForm"},[a("v-card-text",{attrs:{"mb-0":""}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:""}},[a("v-select",{attrs:{items:t.roomContents,"item-text":"title",label:"Kapacitet sobe","return-object":""},on:{input:function(e){t.handleContents(t.room.RoomContent)}},model:{value:t.room.RoomContent,callback:function(e){t.$set(t.room,"RoomContent",e)},expression:"room.RoomContent"}})],1),t._v(" "),a("v-flex",{attrs:{sm12:""}},[a("v-select",{attrs:{items:t.roomTypes,"item-text":"title",label:"Sadrzaj sobe","return-object":""},on:{input:function(e){t.handleTypes(t.room.RoomType)}},model:{value:t.room.RoomType,callback:function(e){t.$set(t.room,"RoomType",e)},expression:"room.RoomType"}})],1)],1),t._v(" "),this.room.passangers.length>0?a("v-layout",{attrs:{row:"",wrap:"","justify-center":""}},[a("v-flex",{attrs:{sm12:"","elevation-4":"","mt-2":""}},[a("v-card",[a("v-list",{attrs:{"two-line":""}},[a("v-subheader",[t._v("\n              Putnici\n            ")]),t._v(" "),t._l(this.room.passangers,function(e,n){return[a("v-divider",{key:n+"-divider"}),t._v(" "),a("v-list-tile",{key:n,on:{click:function(){}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                  "+t._s(e.ime.charAt(0))+"\n                ")]),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[a("strong",[t._v(t._s(e.prezime+", "+e.ime))])])],1),t._v(" "),a("v-list-tile-action",[a("div",{attrs:{"justify-center":"",layout:"","px-0":""}},[a("v-btn",{attrs:{icon:""},on:{click:function(e){t.removePassanger(n)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)])],1)]})],2)],1)],1)],1):t._e()],1),t._v(" "),t.roomTypeAndStructureSelected?a("customer",{ref:"passanger",attrs:{customer:t.passanger,isPassenger:!0}}):t._e(),t._v(" "),t.roomTypeAndStructureSelected?a("v-card-text",[a("v-layout",[a("div",{staticClass:"text-center"},[a("v-btn",{attrs:{center:""},on:{click:function(e){e.preventDefault(),t.addPassanger()}}},[a("v-icon",[t._v("person_add")]),t._v("\n          DODAJ PUTNIKA\n        ")],1)],1)])],1):t._e()],1)},staticRenderFns:[]};var ge=a("VU/8")(pe,me,!1,function(t){a("2FH9")},null,null).exports,fe=a("ccUv"),he=a.n(fe),ke={name:"Arrangement",props:{arrangement:{default:void 0,type:Object}},components:{room:ge,customer:ie},data:function(){var t=this;return{searchHotel:null,agentsSuggestions:[],hotelSuggestions:[],isLoadingHotel:[],lockHotel:!1,isLoadingAgent:!1,lock:!1,searchAgent:null,passanger:new oe,convert:he.a,newRoom:new ve,showDialog:!1,departSearch:null,arrivalSearch:null,departPlaceLoading:!1,arrivalPlaceLoading:!1,selectService:!1,selectArrangment:!1,departRules:[function(e){return!!t.arrangement.mestoPolaska||"Ovo je obavezan podatak"},function(e){return!!t.arrangement.mestoPolaskaObj||"Morate odabrati jedan od ponudjenih opcija"}],arrivalRules:[function(e){return!!t.arrangement.mestoPristanista||"Ovo je obavezan podatak"}],dateStartingRules:[function(e){return!!t.arrangement.datumPocetka||"Datum pocetka je obavezan podatak"},function(t){return I()(t,"DD.MM.YYYY").isValid()||"Datum pocetka nije validan, koristite format dan.mesec.godina"}],dateEndingRules:[function(e){return!!t.arrangement.datumZavrsetka||"Datum zavrsetka je obavezan podatak"},function(t){return I()(t,"DD.MM.YYYY").isValid()||"Datum zavrsetka nije validan, koristite format dan.mesec.godina"}],dateStarting:null,dateEnding:null,api:new C,destinationRules:[function(t){return!!t||"Destinacija je obavezan podatak"},function(e){return!!t.arrangement.destinacija||"Destinacija je obavezan podatak"},function(e){return!!t.arrangement.destinacijaObj||"Morate odabrati jedan od ponudjenih opcija"}],hotelRules:[function(t){return!!t||"Hotel je obavezan podatak"}],agentRules:[function(t){return!!t||"Agent je obavezan podatak"}],arrangmentTypeRules:[function(t){return!!t||"Tip Aranzmana je obavezan podatak"}],serviceRules:[function(t){return!!t||"Usluga je obavezan podatak"}],isLoading:!1,valid:!1,search:null,destinationSuggestions:[],departSuggestions:[],arrivalSuggestions:[]}},asyncComputed:{servicePicklist:function(){var t=this;return v()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.getPicklist("service");case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,t)}))()},arrangmentTypePicklist:function(){var t=this;return v()(l.a.mark(function e(){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.getPicklist("arrangement");case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e,t)}))()}},computed:{arrangmentValid:function(){return this.$refs.arrangmentForm.validate()},isRentedArrangment:function(){var t=this.getArrangmentType(this.arrangement.TypeId),e=null!==t&&void 0!==t?t.value:"";return"avionski"===e||"autobuski"===e},departDateModel:function(){return this.arrangement.datumPocetka},arrivalDateModel:function(){return this.arrangement.datumZavrsetka}},methods:{getServiceText:function(t){return this.servicePicklist.find(function(e){return e.id==t}).title},getArrangementText:function(t){return this.arrangmentTypePicklist.find(function(e){return e.id==t}).title},addPassanger:function(){this.$refs.passanger.addPassanger();this.$refs.passanger.customerValid&&(this.arrangement.passangers.push(this.passanger),this.passanger=new oe,this.showDialog=!1)},setDateStart:function(t){this.arrangement.datumPocetka=this.parseDate(t),null!==this.arrangement.brojDana&&this.setEndStart(this.arrangement.brojDana)},setEndStart:function(t){var e=I()(this.arrangement.datumPocetka,"YYYY-MM-DD").add(t,"days").format("DD.MM.YYYY");this.dateEnding=e,this.arrangement.datumZavrsetka=this.parseDate(e)},removeRoom:function(t){this.arrangement.rooms=this.arrangement.rooms.filter(function(e,a){return t!==a})},editRoom:function(t,e){this.removeRoom(t),this.newRoom=e,this.showDialog=!0},removePassanger:function(t){this.arrangement.passangers=this.arrangement.passangers.filter(function(e,a){return a!=t})},getArrangmentType:function(t){return null===this.arrangmentTypePicklist?null:this.arrangmentTypePicklist.find(function(e){return e.id===t})},setDestinationSuggestion:function(t){var e=this.convert(t.description);this.search=e,this.arrangement.destinacija=e,this.arrangement.destinacijaObj=new de(e,t.id)},setDepartSuggestion:function(t){var e=this.convert(t.description);this.departSearch=e,this.arrangement.mestoPolaska=e,this.arrangement.mestoPolaskaObj=new de(e,t.id)},setAgentSuggestion:function(t){this.lock=!1,this.searchAgent=t.name,this.arrangement.agent=t.name,this.arrangement.agentObj=t},setHotelSuggestion:function(t){this.lockHotel=!1,this.searchHotel=t.name,this.arrangement.hotel=t.name,this.arrangement.hotelObj=t},parseDate:function(t){return t?I()(t,"DD.MM.YYYY").format("YYYY-MM-DD"):null},setNumberOfDays:function(){var t=I()(this.arrangement.datumPocetka,"YYYY-MM-DD"),e=I()(this.arrangement.datumZavrsetka,"YYYY-MM-DD");if(t.isValid()&&e.isValid()){console.log(t,e);var a=e.diff(t,"days")-1+" noci / "+e.diff(t,"days")+" dana";this.arrangement.brojDana=a}},addRoom:function(){this.$refs.room.validateRoom()&&(this.arrangement.rooms.push(this.newRoom),this.newRoom=new ve,this.showDialog=!1)},yourCallBackFunction:function(t){return console.log("heeyyyy"),t.preventDefault(),!1}},watch:{search:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";arguments[1];if(null!=t&&t.length<10){var e=this;this.isLoading=!0,this.arrangement.destinacijaObj=null,this.api.getPlaceSuggestion(t).then(function(t){e.destinationSuggestions=t.data}).catch(function(t){console.log(t)})}},departSearch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";arguments[1];if(null!=t&&t.length<10){var e=this;this.departPlaceLoading=!0,this.arrangement.mestoPolaskaObj=null,this.api.getPlaceSuggestion(t).then(function(t){e.departSuggestions=t.data}).catch(function(t){console.log(t)})}},arrivalSearch:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";arguments[1];if(null!=t&&t.length<10){var e=this;this.arrivalPlaceLoading=!0,this.api.getPlaceSuggestion(t).then(function(t){e.arrivalSuggestions=t.data}).catch(function(t){console.log(t)})}},searchAgent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";arguments[1];if(null!=t&&t.length<10&&this.lock){var e=this;this.isLoadingAgent=!0,this.arrangement.agentObj=null,this.api.getAgentSuggestion(t).then(function(t){e.agentsSuggestions=t.data}).catch(function(t){console.log(t)})}},searchHotel:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";arguments[1];if(null!=t&&t.length<10&&this.lockHotel){var e=this;this.isLoadingHotel=!0,this.arrangement.hotelObj=null,this.api.getHotelSuggestion(t).then(function(t){e.hotelSuggestions=t.data}).catch(function(t){console.log(t)})}},departDateModel:function(t){console.log("this triggered"),this.dateStarting=I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()},arrivalDateModel:function(t){console.log("this triggered also"),this.dateEnding=I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()}}},_e={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-form",{ref:"arrangmentForm",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-menu",{staticClass:"elevation-0",attrs:{transition:"slide-y-transition","nudge-bottom":100,"full-width":""},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[a("v-text-field",{attrs:{slot:"activator",rules:t.destinationRules,label:"Destinacija","prepend-icon":"place",required:""},slot:"activator",model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),t.destinationSuggestions?a("v-list",{attrs:{transition:"slide-y-transition"}},t._l(t.destinationSuggestions,function(e){return a("v-list-tile",{directives:[{name:"show",rawName:"v-show",value:t.destinationSuggestions.length>0,expression:"destinationSuggestions.length > 0"}],key:e.id,on:{click:function(a){t.setDestinationSuggestion(e)}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                "+t._s(t.convert(e.description.charAt(0)))+"\n              ")]),t._v(" "),a("v-list-tile-title",[t._v(t._s(t.convert(e.description)))])],1)})):t._e()],1)],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-menu",{staticClass:"elevation-0",attrs:{transition:"slide-y-transition","nudge-bottom":100,"full-width":""},model:{value:t.isLoadingHotel,callback:function(e){t.isLoadingHotel=e},expression:"isLoadingHotel"}},[a("v-text-field",{attrs:{slot:"activator",label:"Hotel",rules:t.hotelRules,required:""},on:{focus:function(e){t.lockHotel=!0},blur:function(e){t.lockHotel=!1}},slot:"activator",model:{value:t.searchHotel,callback:function(e){t.searchHotel=e},expression:"searchHotel"}}),t._v(" "),t.hotelSuggestions?a("v-list",{attrs:{transition:"slide-y-transition"}},t._l(t.hotelSuggestions,function(e){return a("v-list-tile",{directives:[{name:"show",rawName:"v-show",value:t.hotelSuggestions.length>0,expression:"hotelSuggestions.length > 0"}],key:e.id,on:{click:function(a){t.setHotelSuggestion(e)}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                "+t._s(e.name.charAt(0))+"\n              ")]),t._v(" "),a("v-list-tile-title",[t._v(t._s(e.name))])],1)})):t._e()],1)],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-text-field",{attrs:{"prepend-icon":"event",label:"Datum Pocetka",rules:t.dateStartingRules,"validate-on-blur":"",mask:"##.##.####"},on:{blur:function(e){t.setDateStart(t.dateStarting)}},model:{value:t.dateStarting,callback:function(e){t.dateStarting=e},expression:"dateStarting"}})],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-text-field",{attrs:{"prepend-icon":"event",type:"number",label:"Broj noci"},on:{blur:function(e){t.setEndStart(t.arrangement.brojDana)}},model:{value:t.arrangement.brojDana,callback:function(e){t.$set(t.arrangement,"brojDana",e)},expression:"arrangement.brojDana"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-text-field",{attrs:{"prepend-icon":"event",label:"Datum Zavrsetka",rules:t.dateEndingRules,"validate-on-blur":"",mask:"##.##.####"},model:{value:t.dateEnding,callback:function(e){t.dateEnding=e},expression:"dateEnding"}})],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-select",{attrs:{items:t.servicePicklist,"item-text":"title","item-value":"id",label:"Usluga",rules:t.serviceRules},model:{value:t.arrangement.ServiceId,callback:function(e){t.$set(t.arrangement,"ServiceId",e)},expression:"arrangement.ServiceId"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-select",{attrs:{items:t.arrangmentTypePicklist,rules:t.arrangmentTypeRules,"item-text":"title","item-value":"id","open-on-click":"",label:"Tip Aranžmana"},model:{value:t.arrangement.TypeId,callback:function(e){t.$set(t.arrangement,"TypeId",e)},expression:"arrangement.TypeId"}})],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-menu",{staticClass:"elevation-0",attrs:{transition:"slide-y-transition","nudge-bottom":100,"full-width":""},model:{value:t.isLoadingAgent,callback:function(e){t.isLoadingAgent=e},expression:"isLoadingAgent"}},[a("v-text-field",{attrs:{slot:"activator",label:"Agent",rule:t.agentRules,required:""},on:{focus:function(e){t.lock=!0},blur:function(e){t.lock=!1}},slot:"activator",model:{value:t.searchAgent,callback:function(e){t.searchAgent=e},expression:"searchAgent"}}),t._v(" "),t.agentsSuggestions?a("v-list",{attrs:{transition:"slide-y-transition"}},t._l(t.agentsSuggestions,function(e){return a("v-list-tile",{directives:[{name:"show",rawName:"v-show",value:t.agentsSuggestions.length>0,expression:"agentsSuggestions.length > 0"}],key:e.id,on:{click:function(a){t.setAgentSuggestion(e)}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                  "+t._s(e.name.charAt(0))+"\n                ")]),t._v(" "),a("v-list-tile-title",[t._v(t._s(e.name))])],1)})):t._e()],1)],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[t.isRentedArrangment?a("v-menu",{staticClass:"elevation-0",attrs:{transition:"slide-y-transition","nudge-bottom":100,"full-width":""},model:{value:t.departPlaceLoading,callback:function(e){t.departPlaceLoading=e},expression:"departPlaceLoading"}},[a("v-text-field",{attrs:{slot:"activator",rules:t.isRentedArrangment?t.departRules:[],label:"Mesto odlaska","prepend-icon":"place",required:""},slot:"activator",model:{value:t.departSearch,callback:function(e){t.departSearch=e},expression:"departSearch"}}),t._v(" "),t.departSuggestions?a("v-list",{attrs:{transition:"slide-y-transition"}},t._l(t.departSuggestions,function(e){return a("v-list-tile",{directives:[{name:"show",rawName:"v-show",value:t.departSuggestions.length>0,expression:"departSuggestions.length > 0"}],key:e.id,on:{click:function(a){t.setDepartSuggestion(e)}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                  "+t._s(t.convert(e.description.charAt(0)))+"\n                ")]),t._v(" "),a("v-list-tile-title",[t._v(t._s(t.convert(e.description)))])],1)})):t._e()],1):t._e()],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-btn",{attrs:{slot:"activator",block:"",large:"",center:""},on:{click:function(e){e.preventDefault(),t.showDialog=!t.showDialog}},slot:"activator"},[a("v-icon",[t._v("person_add")]),t._v("\n          DODAJ SAPUTNIKA\n        ")],1)],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Dodaj Saputnika")])]),t._v(" "),a("v-card-text",[a("customer",{ref:"passanger",attrs:{customer:t.passanger,isPassenger:!0},on:{clearCustomer:function(e){t.passanger=new t.Customer}}})],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){e.preventDefault(),t.showDialog=!1}}},[t._v("Obustavi")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){e.preventDefault(),t.addPassanger(e)}}},[t._v("Sacuvaj")])],1)],1)],1)],1),t._v(" "),a("v-layout",[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-textarea",{attrs:{solo:"","elevation-3":"",name:"input-7-4",label:"Opis sobe"},model:{value:t.arrangement.roomDescription,callback:function(e){t.$set(t.arrangement,"roomDescription",e)},expression:"arrangement.roomDescription"}})],1),t._v(" "),t.arrangement.passangers.length>0?a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":"","elevation-4":"","mt-2":""}},[a("v-card",[a("v-list",{attrs:{"two-line":""}},[a("v-subheader",[t._v("\n              Saputnici\n            ")]),t._v(" "),t._l(t.arrangement.passangers,function(e,n){return[a("v-divider",{key:n+"-divider"}),t._v(" "),a("v-list-tile",{key:n,on:{click:function(){}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                  "+t._s(e.ime.charAt(0))+"\n                ")]),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[a("strong",[t._v(t._s(e.prezime+", "+e.ime))])])],1),t._v(" "),a("v-list-tile-action",[a("div",{attrs:{"justify-center":"",layout:"","px-0":""}},[a("v-btn",{attrs:{icon:""},on:{click:function(e){t.removePassanger(n)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)])],1)]})],2)],1)],1):t._e()],1)],1)],1)},staticRenderFns:[]};var be=a("VU/8")(ke,_e,!1,function(t){a("me3Y")},"data-v-0eb7b75e",null).exports,xe={name:"Checkout",components:{},props:{checkout:{default:void 0,type:Object}},data:function(){var t=this;return{avans:!1,dueDate:null,valid:!1,netoRules:[function(t){return!!t||"Neto cena je obavezan podatak"}],brutoRules:[function(t){return!!t||"Bruto cena je obavezan podatak"}],dueDateRules:[function(e){return!!t.checkout.rokUplate||"Datum poslednje uplate je obavezan podatak"},function(t){return I()(t,"DD.MM.YYYY").isValid()||"Datum poslednje uplate nije validan, koristite format dan.mesec.godina"},function(t){return new Date(I()(t,"DD.MM.YYYY"))>new Date||"Datum poslednje uplate polaska se ne nalazi u buducnosti"}]}},computed:{checkoutPaymentDateModel:function(){return this.checkout.rokUplate},checkoutValid:function(){return this.$refs.payment.validate()}},filters:{decimal:function(t){return t?(t=t.toString().split("."))[0]+"."+(void 0!==t[1]?t[1]:"00"):""}},methods:{limitInput:function(t){parseInt(this.checkout.neto)<parseInt(t)&&(this.checkout.avans=this.checkout.neto)},parseDate:function(t){return t?I()(t,"DD.MM.YYYY").format("YYYY-MM-DD").toString():null},toDin:function(){var t=this;this.api.euroToRsd().then(function(e){var a=e.data,n=a.substring(a.lastIndexOf("{"),a.lastIndexOf("}"));t.$store.commit("setCustomerId",JSON.parse(n).val)})},avansDisabled:function(t){if(t){var e=parseInt((new Date).getYear())+1900;this.checkout.rokUplate=e+"-12-31"}else this.checkout.avans=null,this.checkout.rokUplate=null}},watch:{checkoutPaymentDateModel:function(t){this.dueDate=I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()}}},je={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-form",{ref:"payment",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-layout",[a("v-flex",{attrs:{xs8:"",md6:"","offset-md2":""}},[a("v-textarea",{attrs:{solo:"","elevation-3":"",name:"input-7-4",label:"Napomena"},model:{value:t.checkout.notes,callback:function(e){t.$set(t.checkout,"notes",e)},expression:"checkout.notes"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-text-field",{attrs:{label:"Neto Cena Karti",prefix:"€",type:"number",rules:t.netoRules,transition:"slide-y-transition"},model:{value:t.checkout.neto,callback:function(e){t.$set(t.checkout,"neto",e)},expression:"checkout.neto"}})],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-text-field",{attrs:{label:"Bruto Cena Karti",prefix:"€",type:"number",rules:t.brutoRules,transition:"slide-y-transition"},model:{value:t.checkout.bruto,callback:function(e){t.$set(t.checkout,"bruto",e)},expression:"checkout.bruto"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-switch",{attrs:{label:t.avans?"Sa avansom ":"Bez avansa"},on:{change:t.avansDisabled},model:{value:t.avans,callback:function(e){t.avans=e},expression:"avans"}})],1)],1),t._v(" "),t.avans?a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-text-field",{attrs:{label:"Uplacen avans u iznosu",prefix:"€",type:"number",transition:"slide-y-transition"},on:{change:t.limitInput},model:{value:t.checkout.avans,callback:function(e){t.$set(t.checkout,"avans",e)},expression:"checkout.avans"}})],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-text-field",{attrs:{"prepend-icon":"event",label:"Uplata dozvoljena do",rules:t.avans?t.dueDateRules:[],mask:"##.##.####"},on:{blur:function(e){t.checkout.rokUplate=t.parseDate(t.dueDate)}},model:{value:t.dueDate,callback:function(e){t.dueDate=e},expression:"dueDate"}})],1)],1):t._e()],1)},staticRenderFns:[]};var ye=a("VU/8")(xe,je,!1,function(t){a("KEAq")},null,null).exports,we=function t(e,a,n,s,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;m()(this,t),this.id=null,this.neto=e||null,this.bruto=a||null,this.avans=n||null,this.rokUplate=s||null,this.notes=r||null,this.customerId=i,this.avansSet=!1},De={name:"ArrangmentStore",data:function(){return{showLoading:!1,loadingMessage:"",proceed:!1,api:new C,step:1,customer:new oe,arrangement:new xt,checkout:new we}},components:{customer:ie,arrangement:be,checkout:ye,"arrangement-details":wt},computed:{isEditMode:function(){return void 0!==this.$route.params.id},arrangementSummary:function(){var t=this.arrangement;return t.Client=this.customer,void 0!=this.$refs.arrangement&&(t.searchHotel=this.$refs.arrangement.searchHotel,t.searchAgent=this.$refs.arrangement.searchAgent,t.serviceText=this.$refs.arrangement.getServiceText(this.arrangement.ServiceId),t.arrangementTypeText=this.$refs.arrangement.getServiceText(this.arrangement.ServiceId)),t.numberOfPassangers=1+this.arrangement.passangers.length,t}},methods:{parseDate:function(t){t=I()(t,I.a.ISO_8601).format("DD.MM.YYYY");return I()(t,"DD.MM.YYYY").isValid()?t:"-"},newCustomerInstance:function(){this.customer=new oe},toCheckout:function(){var t=this.$refs.customer.customerValid,e=this.$refs.arrangement.arrangmentValid;if(e&&t)this.step=2;else{var a=t?"":"Nevalidni podatci za musteriju \n";a+=e?"":"Nevalidni podatci za aranzman \n",w.error(a)}},setDesination:function(t){return new de(t.destinacija,t.google_id,t.id)},getPlan:function(t){var e=this;return v()(l.a.mark(function a(){var n,s;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e.loadingMessage="Učitavanje Aranžmana u toku",e.showLoading=!0,a.next=5,e.api.getPlansById(t);case 5:n=a.sent,e.$refs.checkout.avans=n.data.avans>0,pt.a.assign(e.checkout,pt.a.pick(n.data,pt.a.keys(e.checkout))),pt.a.assign(e.customer,pt.a.pick(n.data.Client,pt.a.keys(e.customer))),pt.a.assign(e.arrangement,pt.a.pick(n.data.Arrangements[0],pt.a.keys(e.arrangement))),e.$refs.arrangement.setDestinationSuggestion(e.setDesination(n.data.Arrangements[0].Destination)),null!=n.data.Arrangements[0].Depart&&e.$refs.arrangement.setDepartSuggestion(e.setDesination(n.data.Arrangements[0].Depart)),e.$refs.arrangement.setHotelSuggestion(n.data.Arrangements[0].Hotel),e.$refs.arrangement.setAgentSuggestion(n.data.Arrangements[0].Agent),s=n.data.Arrangements[0].PassangersArrangements.filter(function(t){return null!==t.Passanger}),e.arrangement.passangers=s.map(function(t){return t.Passanger}),e.loadingMessage="Aranžmana uspesno ucitan",e.showLoading=!1,a.next=25;break;case 20:a.prev=20,a.t0=a.catch(0),e.loadingMessage="Aranžmana nije potpuno ucitan",e.showLoading=!1,w.error(a.t0.toString());case 25:case"end":return a.stop()}},a,e,[[0,20]])}))()},endCheckout:function(){var t=this;return v()(l.a.mark(function e(){var a,n,s,r,i,o,c,u,d,v;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],!t.$refs.checkout.checkoutValid){e.next=80;break}return t.showLoading=!0,e.prev=3,t.loadingMessage="Zapisivanje Musterije u bazu",e.next=7,t.api.saveCustomer(t.customer);case 7:return n=e.sent,a.push({data:n,request:"saveCustomer"}),t.loadingMessage="Zapisivanje Destinacije u bazu",e.next=12,t.api.saveDestination(t.arrangement.destinacijaObj);case 12:if(s=e.sent,null===t.arrangement.mestoPolaskaObj){e.next=19;break}return e.next=16,t.api.saveDestination(t.arrangement.mestoPolaskaObj);case 16:r=e.sent,a.push({data:r,request:"saveDestination"}),t.arrangement.DepartId=r.data.id;case 19:if(t.loadingMessage="Zapisivanje Mesta odlaska u bazu",null===t.arrangement.mestoPristanistaObj){e.next=26;break}return e.next=23,t.api.saveDestination(t.arrangement.mestoPristanistaObj);case 23:i=e.sent,a.push({data:i,request:"saveDestination"}),t.arrangement.ArrivalId=i.data.id;case 26:if(t.loadingMessage="Zapisivanje Hotela u bazu",null!==t.arrangement.hotelObj){e.next=32;break}return e.next=30,t.api.addHotel(t.$refs.arrangement.searchHotel);case 30:o=e.sent,t.arrangement.hotelObj=o.data;case 32:if(t.loadingMessage="Zapisivanje Agenta u bazu",null!==t.arrangement.agentObj){e.next=38;break}return e.next=36,t.api.addAgent(t.$refs.arrangement.searchAgent);case 36:c=e.sent,t.arrangement.agentObj=c.data;case 38:return t.loadingMessage="Zapisivanje Kupovine u bazu",t.checkout.customerId=n.data.id,e.next=42,t.api.savePlan(t.checkout);case 42:return u=e.sent,t.loadingMessage="Zapisivanje Arannžmana u bazu",t.arrangement.DestinationId=s.data.id,t.arrangement.ClientId=n.data.id,t.arrangement.PlanId=u.data.id,t.arrangement.HotelId=t.arrangement.hotelObj.id,t.arrangement.AgentId=t.arrangement.agentObj.id,e.next=51,t.api.saveArrangement(t.arrangement);case 51:if(d=e.sent,t.loadingMessage="Zapisivanje Putnika u bazu",!(t.arrangement.passangers.length>0)){e.next=66;break}return e.next=56,t.api.setClientAsPassangerOnArrangement(n.data.id,d.data.id);case 56:e.t0=l.a.keys(t.arrangement.passangers);case 57:if((e.t1=e.t0()).done){e.next=64;break}return v=e.t1.value,t.arrangement.passangers[v].ArrangementId=d.data.id,e.next=62,t.api.addPassangerOnArrangement(t.arrangement.passangers[v]);case 62:e.next=57;break;case 64:e.next=68;break;case 66:return e.next=68,t.api.setClientAsPassangerOnArrangement(n.data.id,d.data.id);case 68:t.loadingMessage="Uspesno zapisana kupovina Aranžmana u bazu",t.proceed=!0,Ne.push({path:"/dashboard/plans"}),e.next=77;break;case 73:e.prev=73,e.t2=e.catch(3),t.loadingMessage="Zapisivanje nije uspelo, probajte opet",w.error("Neuspesno upisivanje prodaje"+e.t2.toString());case 77:t.showLoading=!1,e.next=81;break;case 80:w.error("Nevalidni podatci prodaje");case 81:t.loadingMessage="";case 82:case"end":return e.stop()}},e,t,[[3,73]])}))()},checkoutUpdate:function(){var t=this;return v()(l.a.mark(function e(){var a,n,s,r,i,o,c,u;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.checkout.checkoutValid){e.next=67;break}return t.showLoading=!0,e.prev=2,t.loadingMessage="Ažuriranje u toku",e.next=6,t.api.saveCustomer(t.customer);case 6:return a=e.sent,e.next=9,t.api.saveDestination(t.arrangement.destinacijaObj);case 9:if(n=e.sent,null===t.arrangement.mestoPolaskaObj){e.next=15;break}return e.next=13,t.api.saveDestination(t.arrangement.mestoPolaskaObj);case 13:s=e.sent,t.arrangement.DepartId=s.data.id;case 15:if(console.log(t.$refs.arrangement.searchHotel,t.$refs.arrangement.searchAgent),null!==t.arrangement.hotelObj){e.next=21;break}return e.next=19,t.api.addHotel(t.$refs.arrangement.searchHotel);case 19:r=e.sent,t.arrangement.hotelObj=r.data;case 21:if(null!==t.arrangement.agentObj){e.next=26;break}return e.next=24,t.api.addAgent(t.$refs.arrangement.searchAgent);case 24:i=e.sent,t.arrangement.agentObj=i.data;case 26:return t.checkout.customerId=a.data.id,e.next=29,t.api.updatePlan(t.checkout);case 29:return o=e.sent,t.arrangement.DestinationId=n.data.id,t.arrangement.ClientId=a.data.id,t.arrangement.PlanId=o.data.id,t.arrangement.HotelId=t.arrangement.hotelObj.id,t.arrangement.AgentId=t.arrangement.agentObj.id,e.next=37,t.api.saveChangedArrangement(t.arrangement);case 37:return c=e.sent,e.next=40,t.api.removeAllRoomsFromArrangement(c.data.id);case 40:return e.next=42,t.api.removeAllPassangersFromArrangement(c.data.id);case 42:if(!(t.arrangement.passangers.length>0)){e.next=55;break}return e.next=45,t.api.setClientAsPassangerOnArrangement(a.data.id,c.data.id);case 45:e.t0=l.a.keys(t.arrangement.passangers);case 46:if((e.t1=e.t0()).done){e.next=53;break}return u=e.t1.value,t.arrangement.passangers[u].ArrangementId=c.data.id,e.next=51,t.api.addPassangerOnArrangement(t.arrangement.passangers[u]);case 51:e.next=46;break;case 53:e.next=57;break;case 55:return e.next=57,t.api.setClientAsPassangerOnArrangement(a.data.id,c.data.id);case 57:t.loadingMessage="Ažuriranje u uspelo",t.proceed=!0,Ne.push({path:"/dashboard/plans"}),e.next=66;break;case 62:e.prev=62,e.t2=e.catch(2),t.loadingMessage="Ažuriranje u nije uspelo, probajte ponovo",w.error("Neuspesno upisivanje prodaje"+e.t2.toString());case 66:t.showLoading=!1;case 67:t.loadingMessage="";case 68:case"end":return e.stop()}},e,t,[[2,62]])}))()}},mounted:function(){void 0!==this.$route.params.id&&this.getPlan(this.$route.params.id)},beforeRouteLeave:function(t,e,a){2!=this.step||this.proceed?a():(this.step=1,a(!1))}},Pe={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[2==t.step?a("v-card",[a("arrangement-details",{attrs:{arrangement:t.arrangementSummary}})],1):t._e(),t._v(" "),a("v-stepper",{attrs:{vertical:""},model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("v-stepper-step",{attrs:{complete:t.step>1,step:"1"}},[t._v("\n      Novi Aranzman\n    ")]),t._v(" "),a("v-stepper-content",{attrs:{step:"1"}},[a("v-subheader",[t._v("Podatci o nosiocu putovanja")]),t._v(" "),a("customer",{ref:"customer",attrs:{customer:t.customer},on:{newCustomer:t.newCustomerInstance}}),t._v(" "),a("v-divider"),t._v(" "),a("v-subheader",[t._v("Aranžmani")]),t._v(" "),a("arrangement",{ref:"arrangement",attrs:{arrangement:t.arrangement}}),t._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(e){t.toCheckout()}}},[t._v("Naplati")]),t._v(" "),a("v-btn",{attrs:{flat:""}},[t._v("Obustavi")])],1),t._v(" "),a("v-stepper-step",{attrs:{complete:t.step>2,step:"2"}},[t._v("\n      Naplata\n      ")]),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("checkout",{ref:"checkout",attrs:{checkout:t.checkout}}),t._v(" "),t.isEditMode?t._e():a("v-btn",{attrs:{color:"primary"},on:{click:t.endCheckout}},[t._v("Zakljuci Prodaju")]),t._v(" "),t.isEditMode?a("v-btn",{attrs:{color:"primary"},on:{click:t.checkoutUpdate}},[t._v("Sacuvaj Promene")]):t._e(),t._v(" "),a("v-btn",{attrs:{flat:""},on:{click:function(e){t.step=1}}},[t._v("Nazad")])],1)],1),t._v(" "),a("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.showLoading,callback:function(e){t.showLoading=e},expression:"showLoading"}},[a("v-card",{attrs:{color:"blue darken-3"}},[a("v-card-text",{staticStyle:{color:"#fff"},attrs:{"text-center":""}},[t._v("\n        "+t._s(t.loadingMessage)+"\n        "),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},staticRenderFns:[]};var Ce=a("VU/8")(De,Pe,!1,function(t){a("DanA")},null,null).exports,Se={name:"Ticket",components:{customer:ie},props:{ticket:{default:void 0,type:Object},passangers:{default:function(){return[]},type:Array}},data:function(){var t=this;return{lock:!1,convert:he.a,departureRules:[function(t){return!!t||"Mesto polaska je obavezan podatak"},function(e){return!!t.ticket.putovanjeOd||"Mesto polaska je obavezan podatak"},function(e){return!!t.ticket.putovanjeOdObj||"Morate odabrati jedan od ponudjenih opcija"}],arrivalRules:[function(t){return!!t||"Destinacija je obavezan podatak"},function(e){return!!t.ticket.putovanjeDo||"Mesto polaska je obavezan podatak"},function(e){return!!t.ticket.putovanjeDoObj||"Morate odabrati jedan od ponudjenih opcija"}],departureDateRules:[function(e){return!!t.ticket.datumPolaska||"Datum polaska je obavezan podatak"},function(t){return I()(t,"DD.MM.YYYY").isValid()||"Datum polaska nije validan, koristite format dan.mesec.godina"}],arrivalDateRules:[function(e){return!!t.ticket.datumDolaska||"Datum povratka je obavezan podatak"},function(t){return I()(t,"DD.MM.YYYY").isValid()||"Datum povratka nije validan, koristite format dan.mesec.godina"}],brojRezervacijeRules:[function(t){return!!t||"Broj rezervacije je obavezan podatak"}],destinationSuggestions:[],arrivalSuggestions:[],companiesSuggestions:[],isLoading:!1,isLoadingArr:!1,isLoadingComp:!1,search:null,searchArr:null,searchComp:null,passanger:new oe,showDialog:!1,showSuggestions:!1,showPlacesSuggestions:!1,valid:!1,departureDate:null,arrivalDate:null,show:!1,api:new C,roundTrip:!1,destination:""}},computed:{ticketValid:function(){return this.$refs.ticketForm.validate()},departureDateModel:function(){return this.ticket.datumPolaska},arrivalDateModel:function(){return this.ticket.datumDolaska}},methods:{setDepartureSuggestion:function(t){var e=this.convert(t.description);this.search=e,this.ticket.putovanjeOd=e,this.ticket.putovanjeOdObj=new de(e,t.id)},setArrivalSuggestion:function(t){var e=this.convert(t.description);this.searchArr=e,this.ticket.putovanjeDo=e,this.ticket.putovanjeDoObj=new de(e,t.id)},setCompanySuggestion:function(t){this.lock=!1,this.searchComp=t.name,this.ticket.avioKompanija=t.name,this.ticket.avioKompanijaObj=t},addPassanger:function(){var t=this.$refs.passanger.addPassanger();!1!==t&&(this.passangers.push(t),this.passanger=new oe,this.showDialog=!1)},parseDate:function(t){return t?I()(t,"DD.MM.YYYY").format("YYYY-MM-DD"):null},addCustomer:function(t){this.passangers.push(t)}},watch:{search:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";arguments[1];if(null!=t&&t.length<10){var e=this;this.isLoading=!0,this.ticket.putovanjeOdObj=null,this.api.getPlaceSuggestion(t).then(function(t){e.destinationSuggestions=t.data}).catch(function(t){console.log(t)})}},searchArr:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";arguments[1];if(null!=t&&t.length<10){var e=this;this.isLoadingArr=!0,this.ticket.putovanjeDoObj=null,this.api.getPlaceSuggestion(t).then(function(t){e.arrivalSuggestions=t.data}).catch(function(t){console.log(t)})}},searchComp:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";arguments[1];if(null!=t&&t.length<10&&this.lock){var e=this;this.isLoadingComp=!0,this.ticket.avioKompanijaObj=null,this.api.getCompanySuggestion(t).then(function(t){e.companiesSuggestions=t.data}).catch(function(t){console.log(t)})}},departureDateModel:function(t){this.departureDate=I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()},arrivalDateModel:function(t){this.arrivalDate=I()(t,I.a.ISO_8601).format("DD.MM.YYYY").toString()}},mounted:function(){}},Ae={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-card-text",[a("v-form",{ref:"ticketForm",model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-switch",{attrs:{label:"Putovanje u "+(t.roundTrip?"oba pravca ":"jednom pravcu")},model:{value:t.roundTrip,callback:function(e){t.roundTrip=e},expression:"roundTrip"}})],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-menu",{staticClass:"elevation-0",attrs:{transition:"slide-y-transition","full-width":"",bottom:"","offset-y":""},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[a("v-text-field",{attrs:{slot:"activator",rules:t.departureRules,label:"Putovanje Od","prepend-icon":"place",required:""},slot:"activator",model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),t.destinationSuggestions?a("v-list",{attrs:{transition:"slide-y-transition"}},t._l(t.destinationSuggestions,function(e){return a("v-list-tile",{directives:[{name:"show",rawName:"v-show",value:t.destinationSuggestions.length>0,expression:"destinationSuggestions.length > 0"}],key:e.id,on:{click:function(a){t.setDepartureSuggestion(e)}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                "+t._s(e.description.charAt(0))+"\n              ")]),t._v(" "),a("v-list-tile-title",[t._v(t._s(t.convert(e.description)))])],1)})):t._e()],1)],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-menu",{staticClass:"elevation-0",attrs:{transition:"slide-y-transition","full-width":"",bottom:"","offset-y":""},model:{value:t.isLoadingArr,callback:function(e){t.isLoadingArr=e},expression:"isLoadingArr"}},[a("v-text-field",{attrs:{slot:"activator",rules:t.arrivalRules,"prepend-icon":"place",label:"Putovanje Do",required:""},slot:"activator",model:{value:t.searchArr,callback:function(e){t.searchArr=e},expression:"searchArr"}}),t._v(" "),t.arrivalSuggestions?a("v-list",{attrs:{transition:"slide-y-transition"}},t._l(t.arrivalSuggestions,function(e){return a("v-list-tile",{directives:[{name:"show",rawName:"v-show",value:t.arrivalSuggestions.length>0,expression:"arrivalSuggestions.length > 0"}],key:e.id,on:{click:function(a){t.setArrivalSuggestion(e)}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                "+t._s(t.convert(e.description.charAt(0)))+"\n              ")]),t._v(" "),a("v-list-tile-title",[t._v(t._s(t.convert(e.description)))])],1)})):t._e()],1)],1)],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-text-field",{attrs:{"prepend-icon":"event",label:"Datum Polaska",rules:t.departureDateRules,mask:"##.##.####",required:""},on:{blur:function(e){t.ticket.datumPolaska=t.parseDate(t.departureDate)}},model:{value:t.departureDate,callback:function(e){t.departureDate=e},expression:"departureDate"}})],1),t._v(" "),t.roundTrip?a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-text-field",{attrs:{"prepend-icon":"event",label:"Datum Povratka",rules:t.roundTrip?t.arrivalDateRules:null,mask:"##.##.####",required:""},on:{blur:function(e){t.ticket.datumDolaska=t.parseDate(t.arrivalDate)}},model:{value:t.arrivalDate,callback:function(e){t.arrivalDate=e},expression:"arrivalDate"}})],1):t._e()],1),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:""}},[a("v-menu",{staticClass:"elevation-0",attrs:{transition:"slide-y-transition","full-width":"",bottom:"","offset-y":""},model:{value:t.isLoadingComp,callback:function(e){t.isLoadingComp=e},expression:"isLoadingComp"}},[a("v-text-field",{attrs:{slot:"activator",label:"bus"===t.ticket.type?"Kompanija":"Avio Kompanija",required:""},on:{focus:function(e){t.lock=!0},blur:function(e){t.lock=!1}},slot:"activator",model:{value:t.searchComp,callback:function(e){t.searchComp=e},expression:"searchComp"}}),t._v(" "),t.companiesSuggestions?a("v-list",{attrs:{transition:"slide-y-transition"}},t._l(t.companiesSuggestions,function(e){return a("v-list-tile",{directives:[{name:"show",rawName:"v-show",value:t.companiesSuggestions.length>0,expression:"companiesSuggestions.length > 0"}],key:e.id,on:{click:function(a){t.setCompanySuggestion(e)}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                "+t._s(e.name.charAt(0))+"\n              ")]),t._v(" "),a("v-list-tile-title",[t._v(t._s(e.name))])],1)})):t._e()],1)],1),t._v(" "),a("v-flex",{attrs:{sm12:"",md5:"","offset-sm1":""}},[a("v-btn",{attrs:{slot:"activator",center:"",block:""},on:{click:function(e){e.preventDefault(),t.showDialog=!t.showDialog}},slot:"activator"},[a("v-icon",[t._v("person_add")]),t._v("\n            DODAJ SAPUTNIKA\n          ")],1),t._v(" "),a("v-dialog",{attrs:{"max-width":"500px"},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"headline"},[t._v("Dodaj Saputnika")])]),t._v(" "),a("v-card-text",[a("customer",{ref:"passanger",attrs:{customer:t.passanger,isPassenger:!0}})],1),t._v(" "),a("v-card-actions",[a("v-spacer"),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){e.preventDefault(),t.showDialog=!1}}},[t._v("Obustavi")]),t._v(" "),a("v-btn",{attrs:{color:"blue darken-1",flat:""},nativeOn:{click:function(e){e.preventDefault(),t.addPassanger(e)}}},[t._v("Sacuvaj")])],1)],1)],1),t._v(" "),this.passangers.length>0?a("v-card",{attrs:{"mt-1":""}},[a("v-list",{attrs:{"two-line":""}},[a("v-subheader",[t._v("\n              Saputnici\n            ")]),t._v(" "),t._l(t.passangers,function(e,n){return[a("v-divider",{key:n+"-divider"}),t._v(" "),a("v-list-tile",{key:n,on:{click:function(){}}},[a("v-list-tile-avatar",{staticClass:"headline font-weight-light white--text",attrs:{color:"indigo"}},[t._v("\n                  "+t._s(e.ime.charAt(0))+"\n                ")]),t._v(" "),a("v-list-tile-content",[a("v-list-tile-title",[a("strong",[t._v(t._s(e.prezime+", "+e.ime))])]),t._v(" "),a("v-list-tile-sub-title",[a("v-text-field",{attrs:{label:"Broj rezervacije",rules:t.brojRezervacijeRules},model:{value:e.brojRezervacije,callback:function(a){t.$set(e,"brojRezervacije",a)},expression:"passanger.brojRezervacije"}})],1)],1),t._v(" "),a("v-list-tile-action",[a("div",{attrs:{"justify-center":"",layout:"","px-0":""}},[a("v-btn",{attrs:{icon:""},on:{click:function(e){t.$emit("removePassanger",n)}}},[a("v-icon",{attrs:{color:"grey lighten-1"}},[t._v("delete")])],1)],1)])],1)]})],2)],1):t._e()],1)],1)],1)],1)},staticRenderFns:[]};var Me=a("VU/8")(Se,Ae,!1,function(t){a("CDOh")},null,null).exports,Oe={name:"BusTicketStore",data:function(){return{showLoading:!1,loadingMessage:"",proceed:!1,api:new C,step:1,customer:new oe,ticket:new mt("bus"),checkout:new we,passangers:[],brojRezervacijeRules:[function(t){return!!t||"Broj rezervacije je obavezan podatak"}]}},computed:{isValidSale:function(){var t=this.$refs.ticket.ticketValid,e=this.$refs.customer.customerValid,a=null!==this.customer.brojRezervacije;return t&&e&&a},generateErrorMessage:function(){var t=this.$refs.ticket.ticketValid?"":"Nevalidni podatci za kartu";return t+=this.$refs.customer.customerValid?"":" \n Nevalidni podatci za musteriju",t+=null!==this.customer.brojRezervacije?"":" Broj Rezervacije nije unet"},isEditMode:function(){return void 0!==this.$route.params.id}},components:{customer:ie,"bus-ticket":Me,checkout:ye},methods:{parseDate:function(t){t=I()(t,I.a.ISO_8601).format("DD.MM.YYYY");return I()(t,"DD.MM.YYYY").isValid()?t:"-"},newCustomerInstance:function(){this.customer=new oe},removePassanger:function(t){this.passangers=this.passangers.filter(function(e,a){return a!==t})},toCheckout:function(){this.isValidSale?this.step=2:w.error(this.generateErrorMessage)},setTicketDesination:function(t){return new de(t.destinacija,t.google_id,t.id)},getPlan:function(t){var e=this;return v()(l.a.mark(function a(){var n,s;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,e.showLoading=!0,e.loadingMessage="Učitavanje bus karte u toku",a.next=5,e.api.getPlansById(t);case 5:n=a.sent,e.$refs.checkout.avans=n.data.avans>0,pt.a.assign(e.checkout,pt.a.pick(n.data,pt.a.keys(e.checkout))),pt.a.assign(e.customer,pt.a.pick(n.data.Client,pt.a.keys(e.customer))),e.customer.brojRezervacije=n.data.Tickets[0].PassangersTickets.find(function(t){return null!=t.ClientPassanger}).brojRezervacije,pt.a.assign(e.ticket,pt.a.pick(n.data.Tickets[0],pt.a.keys(e.ticket))),e.$refs.ticket.setDepartureSuggestion(e.setTicketDesination(n.data.Tickets[0].Destination)),e.$refs.ticket.setArrivalSuggestion(e.setTicketDesination(n.data.Tickets[0].Arrival)),e.$refs.ticket.setCompanySuggestion(n.data.Tickets[0].Company),e.$refs.ticket.roundTrip=null!==n.data.Tickets[0].datumDolaska,s=n.data.Tickets[0].PassangersTickets.filter(function(t){return null!=t.Passanger}),e.passangers=s.map(function(t){return t.Passanger.brojRezervacije=t.brojRezervacije,t.Passanger}),e.loadingMessage="Učitavanje avionske karte uspešno",a.next=24;break;case 20:a.prev=20,a.t0=a.catch(0),e.loadingMessage="Učitavanje avionske karte nije uspelo",w.error(a.t0.toString());case 24:e.showLoading=!1;case 25:case"end":return a.stop()}},a,e,[[0,20]])}))()},checkoutEnd:function(){var t=this;return v()(l.a.mark(function e(){var a,n,s,r,i,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.checkout.valid){e.next=56;break}return t.showLoading=!0,e.prev=2,t.loadingMessage="Kreiranje bus karte u toku",e.next=6,t.api.saveCustomer(t.customer);case 6:return a=e.sent,e.next=9,t.api.saveDestination(t.ticket.putovanjeOdObj);case 9:return n=e.sent,e.next=12,t.api.saveDestination(t.ticket.putovanjeDoObj);case 12:return s=e.sent,t.checkout.customerId=a.data.id,e.next=16,t.api.savePlan(t.checkout);case 16:if(r=e.sent,null!==t.ticket.avioKompanijaObj){e.next=22;break}return e.next=20,t.api.addCompany(new N(null,t.$refs.ticket.searchComp));case 20:i=e.sent,t.ticket.avioKompanijaObj=i.data;case 22:return t.ticket.DestinationId=n.data.id,t.ticket.ArrivalId=s.data.id,t.ticket.ClientId=a.data.id,t.ticket.PlanId=r.data.id,t.ticket.CompanyId=t.ticket.avioKompanijaObj.id,e.next=29,t.api.saveTicket(t.ticket);case 29:if(o=e.sent,!(t.passangers.length>0)){e.next=43;break}return e.next=33,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 33:e.t0=l.a.keys(t.passangers);case 34:if((e.t1=e.t0()).done){e.next=41;break}return c=e.t1.value,t.passangers[c].TicketId=o.data.id,e.next=39,t.api.savePassanger(t.passangers[c]);case 39:e.next=34;break;case 41:e.next=45;break;case 43:return e.next=45,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 45:t.loadingMessage="Kreiranje bus karte je uspela",t.showLoading=!1,t.proceed=!0,Ne.push({path:"/dashboard/plans"}),e.next=56;break;case 51:e.prev=51,e.t2=e.catch(2),t.loadingMessage="Izmena bus karte nije uspela",t.showLoading=!1,w.error("Neuspesno upisivanje prodaje "+e.t2.toString());case 56:case"end":return e.stop()}},e,t,[[2,51]])}))()},checkoutUpdate:function(){var t=this;return v()(l.a.mark(function e(){var a,n,s,r,i,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.checkout.valid){e.next=58;break}return e.prev=1,t.loadingMessage="Izmena bus karte u toku",t.showLoading=!0,e.next=6,t.api.saveCustomer(t.customer);case 6:return a=e.sent,e.next=9,t.api.saveDestination(t.ticket.putovanjeOdObj);case 9:return n=e.sent,e.next=12,t.api.saveDestination(t.ticket.putovanjeDoObj);case 12:return s=e.sent,t.checkout.customerId=a.data.id,e.next=16,t.api.updatePlan(t.checkout);case 16:if(r=e.sent,null!==t.ticket.avioKompanijaObj){e.next=22;break}return e.next=20,t.api.addCompany(new N(null,t.$refs.ticket.searchComp));case 20:i=e.sent,t.ticket.avioKompanijaObj=i.data;case 22:return t.ticket.DestinationId=n.data.id,t.ticket.ArrivalId=s.data.id,t.ticket.ClientId=a.data.id,t.ticket.PlanId=r.data.id,t.ticket.CompanyId=t.ticket.avioKompanijaObj.id,e.next=29,t.api.saveChangedTicket(t.ticket);case 29:return o=e.sent,e.next=32,t.api.removeAllPassangersFromTicket(o.data.id);case 32:if(!(t.passangers.length>0)){e.next=45;break}return e.next=35,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 35:e.t0=l.a.keys(t.passangers);case 36:if((e.t1=e.t0()).done){e.next=43;break}return c=e.t1.value,t.passangers[c].TicketId=o.data.id,e.next=41,t.api.savePassanger(t.passangers[c]);case 41:e.next=36;break;case 43:e.next=47;break;case 45:return e.next=47,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 47:t.loadingMessage="Kreiranje bus karte je uspela",t.showLoading=!1,t.proceed=!0,Ne.push({path:"/dashboard/plans"}),e.next=58;break;case 53:e.prev=53,e.t2=e.catch(1),t.loadingMessage="Izmena bus karte nije uspela",t.showLoading=!1,w.error("Neuspesno upisivanje prodaje "+e.t2.toString());case 58:case"end":return e.stop()}},e,t,[[1,53]])}))()}},mounted:function(){void 0!==this.$route.params.id&&this.getPlan(this.$route.params.id),console.log(this.$route.params.id)},beforeRouteLeave:function(t,e,a){2!=this.step||this.proceed?a():(this.step=1,a(!1))}},Ie={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[2==t.step?a("v-layout",{attrs:{row:"","px-5":"","py-4":""}},[a("v-flex",{attrs:{xs4:"",sm2:""}},[a("h3",{staticStyle:{"text-decoration":"underline"}},[t._v("Nosilac Putovanja")]),t._v(" "),a("ul",{staticStyle:{"list-style-type":"none",padding:"0"}},[a("li",[t._v("Ime Prezime: "),a("strong",[t._v(t._s(t.customer.ime+" "+t.customer.prezime))])]),t._v(" "),a("li",[t._v("Broj Telefona: "),a("strong",[t._v(t._s(t.customer.brojTelefona))])]),t._v(" "),a("li",[t._v("Email: "),a("strong",[t._v(t._s(t.customer.email))])]),t._v(" "),a("li",[t._v("Broj Pasosa: "),a("strong",[t._v(t._s(t.customer.brojPasosa))])]),t._v(" "),a("li",[t._v("Datum Rodjenja: "),a("strong",[t._v(t._s(t.customer.datumRodjenja))])]),t._v(" "),a("li",[t._v("Struka: "),a("strong",[t._v(t._s(t.customer.struka))])])])]),t._v(" "),a("v-divider",{staticClass:"mx-3",attrs:{inset:"",vertical:"",dark:""}}),t._v(" "),a("v-flex",{attrs:{sm5:"",md3:"","hidden-xs-only":""}},[a("h3",{staticStyle:{"text-decoration":"underline"}},[t._v("Bus Karta")]),t._v(" "),a("ul",{staticStyle:{"list-style-type":"none",padding:"0"}},[a("li",[t._v("Putovanje: "),a("strong",[t._v(t._s(t.ticket.putovanjeOd+" - "+t.ticket.putovanjeDo))])]),t._v(" "),a("li",[t._v("\n                Datum polaska/povratka: "),a("strong",[t._v(t._s(t.parseDate(t.ticket.datumPolaska)+" / "+t.parseDate(t.ticket.datumDolaska)))])]),t._v(" "),a("li",[t._v("Kompanija: "),a("strong",[t._v(t._s(t.ticket.avioKompanija))])]),t._v(" "),a("li",[t._v("Broj Putnika: "),a("strong",[t._v(t._s(t.passangers.length+1))])])])])],1):t._e()],1),t._v(" "),a("v-stepper",{attrs:{vertical:""},model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("v-stepper-step",{attrs:{complete:t.step>1,step:"1"}},[t._v("\n      Nova Bus Karta\n    ")]),t._v(" "),a("v-stepper-content",{attrs:{step:"1"}},[a("v-subheader",[t._v("Podatci o putniku")]),t._v(" "),a("customer",{ref:"customer",attrs:{customer:t.customer},on:{newCustomer:t.newCustomerInstance}}),t._v(" "),a("v-divider"),t._v(" "),a("v-subheader",[t._v("Bus Karta")]),t._v(" "),a("bus-ticket",{ref:"ticket",attrs:{ticket:t.ticket,passangers:t.passangers},on:{removePassanger:t.removePassanger}}),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:"","ml-3":""}},[a("v-text-field",{attrs:{label:"Broj rezervacije kupca karte",rules:t.brojRezervacijeRules},model:{value:t.customer.brojRezervacije,callback:function(e){t.$set(t.customer,"brojRezervacije",e)},expression:"customer.brojRezervacije"}})],1)],1),t._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(e){t.toCheckout()}}},[t._v("Naplati")]),t._v(" "),a("v-btn",{attrs:{flat:""}},[t._v("Obustavi")])],1),t._v(" "),a("v-stepper-step",{attrs:{complete:t.step>2,step:"2"}},[t._v("\n      Naplata\n      ")]),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("checkout",{ref:"checkout",attrs:{checkout:t.checkout}}),t._v(" "),t.isEditMode?t._e():a("v-btn",{attrs:{color:"primary"},on:{click:t.checkoutEnd}},[t._v("Zakljuci Prodaju")]),t._v(" "),t.isEditMode?a("v-btn",{attrs:{color:"primary"},on:{click:t.checkoutUpdate}},[t._v("Sacuvaj Promene")]):t._e(),t._v(" "),a("v-btn",{attrs:{flat:""},on:{click:function(e){t.step=1}}},[t._v("Nazad")])],1)],1),t._v(" "),a("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.showLoading,callback:function(e){t.showLoading=e},expression:"showLoading"}},[a("v-card",{attrs:{color:"blue darken-3"}},[a("v-card-text",{staticStyle:{color:"#fff"},attrs:{"text-center":""}},[t._v("\n        "+t._s(t.loadingMessage)+"\n        "),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},staticRenderFns:[]};var ze=a("VU/8")(Oe,Ie,!1,function(t){a("G+Ip")},null,null).exports,Re={name:"FlightTicketStore",data:function(){return{showLoading:!1,loadingMessage:"",proceed:!1,api:new C,step:1,customer:new oe,ticket:new mt("flight"),checkout:new we,passangers:[],brojRezervacijeRules:[function(t){return!!t||"Broj rezervacije je obavezan podatak"}]}},computed:{isValidSale:function(){var t=this.$refs.ticket.ticketValid,e=this.$refs.customer.customerValid,a=null!==this.customer.brojRezervacije;return t&&e&&a},generateErrorMessage:function(){var t=this.$refs.ticket.ticketValid?"":"Nevalidni podatci za kartu";return t+=this.$refs.customer.customerValid?"":" \n Nevalidni podatci za musteriju",t+=null!==this.customer.brojRezervacije?"":" Broj Rezervacije nije unet"},isEditMode:function(){return void 0!==this.$route.params.id}},components:{customer:ie,"flight-ticket":Me,checkout:ye},methods:{parseDate:function(t){t=I()(t,I.a.ISO_8601).format("DD.MM.YYYY");return I()(t,"DD.MM.YYYY").isValid()?t:"-"},newCustomerInstance:function(){this.customer=new oe},removePassanger:function(t){this.passangers=this.passangers.filter(function(e,a){return a!==t})},toCheckout:function(){console.log(this.ticket),this.isValidSale?this.step=2:w.error(this.generateErrorMessage)},setTicketDesination:function(t){return new de(t.destinacija,t.google_id,t.id)},getPlan:function(t){var e=this;return v()(l.a.mark(function a(){var n,s;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.showLoading=!0,e.loadingMessage="Učitavanje avionske karte u toku",a.prev=2,a.next=5,e.api.getPlansById(t);case 5:n=a.sent,e.$refs.checkout.avans=n.data.avans>0,pt.a.assign(e.checkout,pt.a.pick(n.data,pt.a.keys(e.checkout))),pt.a.assign(e.customer,pt.a.pick(n.data.Client,pt.a.keys(e.customer))),e.customer.brojRezervacije=n.data.Tickets[0].PassangersTickets.find(function(t){return null!=t.ClientPassanger}).brojRezervacije,pt.a.assign(e.ticket,pt.a.pick(n.data.Tickets[0],pt.a.keys(e.ticket))),e.$refs.ticket.setDepartureSuggestion(e.setTicketDesination(n.data.Tickets[0].Destination)),e.$refs.ticket.setArrivalSuggestion(e.setTicketDesination(n.data.Tickets[0].Arrival)),e.$refs.ticket.setCompanySuggestion(n.data.Tickets[0].Company),e.$refs.ticket.roundTrip=null!==n.data.Tickets[0].datumDolaska,s=n.data.Tickets[0].PassangersTickets.filter(function(t){return null!=t.Passanger}),e.passangers=s.map(function(t){return t.Passanger.brojRezervacije=t.brojRezervacije,t.Passanger}),e.loadingMessage="Učitavanje avionske karte uspešno",a.next=24;break;case 20:a.prev=20,a.t0=a.catch(2),e.loadingMessage="Učitavanje avionske karte nije uspelo",w.error(a.t0.toString());case 24:e.showLoading=!1;case 25:case"end":return a.stop()}},a,e,[[2,20]])}))()},checkoutEnd:function(){var t=this;return v()(l.a.mark(function e(){var a,n,s,r,i,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.checkout.valid){e.next=57;break}return t.showLoading=!0,e.prev=2,t.loadingMessage="Kreiranje avio karte u toku",e.next=6,t.api.saveCustomer(t.customer);case 6:return a=e.sent,e.next=9,t.api.saveDestination(t.ticket.putovanjeOdObj);case 9:return n=e.sent,e.next=12,t.api.saveDestination(t.ticket.putovanjeDoObj);case 12:return s=e.sent,t.checkout.customerId=a.data.id,e.next=16,t.api.savePlan(t.checkout);case 16:if(r=e.sent,null!==t.ticket.avioKompanijaObj){e.next=22;break}return e.next=20,t.api.addCompany(new N(null,t.$refs.ticket.searchComp));case 20:i=e.sent,t.ticket.avioKompanijaObj=i.data;case 22:return t.ticket.DestinationId=n.data.id,t.ticket.ArrivalId=s.data.id,t.ticket.ClientId=a.data.id,t.ticket.PlanId=r.data.id,t.ticket.CompanyId=t.ticket.avioKompanijaObj.id,e.next=29,t.api.saveTicket(t.ticket);case 29:if(o=e.sent,!(t.passangers.length>0)){e.next=43;break}return e.next=33,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 33:e.t0=l.a.keys(t.passangers);case 34:if((e.t1=e.t0()).done){e.next=41;break}return c=e.t1.value,t.passangers[c].TicketId=o.data.id,e.next=39,t.api.savePassanger(t.passangers[c]);case 39:e.next=34;break;case 41:e.next=45;break;case 43:return e.next=45,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 45:t.proceed=!0,t.loadingMessage="Kreiranje avio karte u uspešno",t.showLoading=!1,Ne.push({path:"/dashboard/plans"}),e.next=57;break;case 51:e.prev=51,e.t2=e.catch(2),t.loadingMessage="Kreiranje avio karte u neuspešno",t.showLoading=!1,console.error(e.t2),w.error("Neuspesno upisivanje prodaje "+e.t2.toString());case 57:case"end":return e.stop()}},e,t,[[2,51]])}))()},checkoutUpdate:function(){var t=this;return v()(l.a.mark(function e(){var a,n,s,r,i,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.checkout.valid){e.next=59;break}return e.prev=1,t.loadingMessage="Izmena avio karte u toku",t.showLoading=!0,e.next=6,t.api.saveCustomer(t.customer);case 6:return a=e.sent,e.next=9,t.api.saveDestination(t.ticket.putovanjeOdObj);case 9:return n=e.sent,e.next=12,t.api.saveDestination(t.ticket.putovanjeDoObj);case 12:return s=e.sent,t.checkout.customerId=a.data.id,e.next=16,t.api.updatePlan(t.checkout);case 16:if(r=e.sent,null!==t.ticket.avioKompanijaObj){e.next=22;break}return e.next=20,t.api.addCompany(new N(null,t.$refs.ticket.searchComp));case 20:i=e.sent,t.ticket.avioKompanijaObj=i.data;case 22:return t.ticket.DestinationId=n.data.id,t.ticket.ArrivalId=s.data.id,t.ticket.ClientId=a.data.id,t.ticket.PlanId=r.data.id,t.ticket.CompanyId=t.ticket.avioKompanijaObj.id,e.next=29,t.api.saveChangedTicket(t.ticket);case 29:return o=e.sent,e.next=32,t.api.removeAllPassangersFromTicket(o.data.id);case 32:if(!(t.passangers.length>0)){e.next=45;break}return e.next=35,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 35:e.t0=l.a.keys(t.passangers);case 36:if((e.t1=e.t0()).done){e.next=43;break}return c=e.t1.value,t.passangers[c].TicketId=o.data.id,e.next=41,t.api.savePassanger(t.passangers[c]);case 41:e.next=36;break;case 43:e.next=47;break;case 45:return e.next=47,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 47:t.loadingMessage="Kreiranje avio karte je uspela",t.showLoading=!1,t.proceed=!0,Ne.push({path:"/dashboard/plans"}),e.next=59;break;case 53:e.prev=53,e.t2=e.catch(1),t.loadingMessage="Izmena avio karte nije uspela",t.showLoading=!1,console.error(e.t2),w.error("Neuspesno upisivanje prodaje "+e.t2.toString());case 59:case"end":return e.stop()}},e,t,[[1,53]])}))()}},mounted:function(){void 0!==this.$route.params.id&&this.getPlan(this.$route.params.id),console.log(this.$route.params.id)},beforeRouteLeave:function(t,e,a){2!=this.step||this.proceed?a():(this.step=1,a(!1))}},Te={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[2==t.step?a("v-layout",{attrs:{row:"","px-5":"","py-4":""}},[a("v-flex",{attrs:{xs4:"",sm2:""}},[a("h3",{staticStyle:{"text-decoration":"underline"}},[t._v("Nosilac Putovanja")]),t._v(" "),a("ul",{staticStyle:{"list-style-type":"none",padding:"0"}},[a("li",[t._v("Ime Prezime: "),a("strong",[t._v(t._s(t.customer.ime+" "+t.customer.prezime))])]),t._v(" "),a("li",[t._v("Broj Telefona: "),a("strong",[t._v(t._s(t.customer.brojTelefona))])]),t._v(" "),a("li",[t._v("Email: "),a("strong",[t._v(t._s(t.customer.email))])]),t._v(" "),a("li",[t._v("Broj Pasosa: "),a("strong",[t._v(t._s(t.customer.brojPasosa))])]),t._v(" "),a("li",[t._v("Datum Rodjenja: "),a("strong",[t._v(t._s(t.customer.datumRodjenja))])]),t._v(" "),a("li",[t._v("Struka: "),a("strong",[t._v(t._s(t.customer.struka))])])])]),t._v(" "),a("v-divider",{staticClass:"mx-3",attrs:{inset:"",vertical:"",dark:""}}),t._v(" "),a("v-flex",{attrs:{sm5:"",md3:"","hidden-xs-only":""}},[a("h3",{staticStyle:{"text-decoration":"underline"}},[t._v("Avio Karta")]),t._v(" "),a("ul",{staticStyle:{"list-style-type":"none",padding:"0"}},[a("li",[t._v("Putovanje: "),a("strong",[t._v(t._s(t.ticket.putovanjeOd+" - "+t.ticket.putovanjeDo))])]),t._v(" "),a("li",[t._v("\n                Datum polaska/povratka: "),a("strong",[t._v(t._s(t.parseDate(t.ticket.datumPolaska)+" / "+t.parseDate(t.ticket.datumDolaska)))])]),t._v(" "),a("li",[t._v("Kompanija: "),a("strong",[t._v(t._s(t.ticket.avioKompanija))])]),t._v(" "),a("li",[t._v("Broj Putnika: "),a("strong",[t._v(t._s(t.passangers.length+1))])])])])],1):t._e()],1),t._v(" "),a("v-stepper",{attrs:{vertical:""},model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("v-stepper-step",{attrs:{complete:t.step>1,step:"1"}},[t._v("\n      Nova Avio Karta\n    ")]),t._v(" "),a("v-stepper-content",{attrs:{step:"1"}},[a("v-subheader",[t._v("Podatci o putniku")]),t._v(" "),a("customer",{ref:"customer",attrs:{customer:t.customer},on:{newCustomer:function(e){t.newCustomerInstance()}}}),t._v(" "),a("v-divider"),t._v(" "),a("v-subheader",[t._v("Avio Karta")]),t._v(" "),a("flight-ticket",{ref:"ticket",attrs:{ticket:t.ticket,passangers:t.passangers},on:{removePassanger:t.removePassanger}}),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:"","ml-3":""}},[a("v-text-field",{attrs:{label:"Broj rezervacije kupca karte",rules:t.brojRezervacijeRules},model:{value:t.customer.brojRezervacije,callback:function(e){t.$set(t.customer,"brojRezervacije",e)},expression:"customer.brojRezervacije"}})],1)],1),t._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(e){t.toCheckout()}}},[t._v("Naplati")]),t._v(" "),a("v-btn",{attrs:{flat:""}},[t._v("Obustavi")])],1),t._v(" "),a("v-stepper-step",{attrs:{complete:t.step>2,step:"2"}},[t._v("\n      Naplata\n      ")]),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("checkout",{ref:"checkout",attrs:{checkout:t.checkout}}),t._v(" "),t.isEditMode?t._e():a("v-btn",{attrs:{color:"primary"},on:{click:t.checkoutEnd}},[t._v("Zakljuci Prodaju")]),t._v(" "),t.isEditMode?a("v-btn",{attrs:{color:"primary"},on:{click:t.checkoutUpdate}},[t._v("Sacuvaj Promene")]):t._e(),t._v(" "),a("v-btn",{attrs:{flat:""},on:{click:function(e){t.step=1}}},[t._v("Nazad")])],1)],1),t._v(" "),a("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.showLoading,callback:function(e){t.showLoading=e},expression:"showLoading"}},[a("v-card",{attrs:{color:"blue darken-3"}},[a("v-card-text",{staticStyle:{color:"#fff"},attrs:{"text-center":""}},[t._v("\n        "+t._s(t.loadingMessage)+"\n        "),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},staticRenderFns:[]};var Ye=a("VU/8")(Re,Te,!1,function(t){a("sbBt")},null,null).exports,Ue={name:"FlightTicketStore",data:function(){return{showLoading:!1,loadingMessage:"",proceed:!1,api:new C,step:1,customer:new oe,ticket:new mt(this.$route.params.type),checkout:new we,passangers:[],brojRezervacijeRules:[function(t){return!!t||"Broj rezervacije je obavezan podatak"}]}},computed:{isValidSale:function(){var t=this.$refs.ticket.ticketValid,e=this.$refs.customer.customerValid,a=null!==this.customer.brojRezervacije;return t&&e&&a},generateErrorMessage:function(){var t=this.$refs.ticket.ticketValid?"":"Nevalidni podatci za kartu";return t+=this.$refs.customer.customerValid?"":" \n Nevalidni podatci za musteriju",t+=null!==this.customer.brojRezervacije?"":" Broj Rezervacije nije unet"},isEditMode:function(){return void 0!==this.$route.params.id},getHeader:function(){return"bus"==this.$route.params.type?"Nova Bus Karta":"Nova Avio Karta"},ticketSummary:function(){var t=this.ticket;return t.Client=this.customer,t.numberOfPassangers=1+this.passangers.length,t}},components:{customer:ie,ticket:Me,checkout:ye,"ticket-details":ht},methods:{parseDate:function(t){t=I()(t,I.a.ISO_8601).format("DD.MM.YYYY");return I()(t,"DD.MM.YYYY").isValid()?t:"-"},newCustomerInstance:function(){this.customer=new oe},removePassanger:function(t){this.passangers=this.passangers.filter(function(e,a){return a!==t})},toCheckout:function(){this.isValidSale?this.step=2:w.error(this.generateErrorMessage)},setTicketDesination:function(t){return new de(t.destinacija,t.google_id,t.id)},getPlan:function(t){var e=this;return v()(l.a.mark(function a(){var n,s;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.showLoading=!0,e.loadingMessage="Učitavanje avionske karte u toku",a.prev=2,a.next=5,e.api.getPlansById(t);case 5:n=a.sent,e.$refs.checkout.avans=n.data.avans>0,pt.a.assign(e.checkout,pt.a.pick(n.data,pt.a.keys(e.checkout))),pt.a.assign(e.customer,pt.a.pick(n.data.Client,pt.a.keys(e.customer))),e.customer.brojRezervacije=n.data.Tickets[0].PassangersTickets.find(function(t){return null!=t.ClientPassanger}).brojRezervacije,pt.a.assign(e.ticket,pt.a.pick(n.data.Tickets[0],pt.a.keys(e.ticket))),e.$refs.ticket.setDepartureSuggestion(e.setTicketDesination(n.data.Tickets[0].Destination)),e.$refs.ticket.setArrivalSuggestion(e.setTicketDesination(n.data.Tickets[0].Arrival)),e.$refs.ticket.setCompanySuggestion(n.data.Tickets[0].Company),e.$refs.ticket.roundTrip=null!==n.data.Tickets[0].datumDolaska,s=n.data.Tickets[0].PassangersTickets.filter(function(t){return null!=t.Passanger}),e.passangers=s.map(function(t){return t.Passanger.brojRezervacije=t.brojRezervacije,t.Passanger}),e.loadingMessage="Učitavanje avionske karte uspešno",a.next=24;break;case 20:a.prev=20,a.t0=a.catch(2),e.loadingMessage="Učitavanje avionske karte nije uspelo",w.error(a.t0.toString());case 24:e.showLoading=!1;case 25:case"end":return a.stop()}},a,e,[[2,20]])}))()},checkoutEnd:function(){var t=this;return v()(l.a.mark(function e(){var a,n,s,r,i,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.checkout.valid){e.next=57;break}return t.showLoading=!0,e.prev=2,t.loadingMessage="Kreiranje avio karte u toku",e.next=6,t.api.saveCustomer(t.customer);case 6:return a=e.sent,e.next=9,t.api.saveDestination(t.ticket.putovanjeOdObj);case 9:return n=e.sent,e.next=12,t.api.saveDestination(t.ticket.putovanjeDoObj);case 12:return s=e.sent,t.checkout.customerId=a.data.id,e.next=16,t.api.savePlan(t.checkout);case 16:if(r=e.sent,null!==t.ticket.avioKompanijaObj){e.next=22;break}return e.next=20,t.api.addCompany(new N(null,t.$refs.ticket.searchComp));case 20:i=e.sent,t.ticket.avioKompanijaObj=i.data;case 22:return t.ticket.DestinationId=n.data.id,t.ticket.ArrivalId=s.data.id,t.ticket.ClientId=a.data.id,t.ticket.PlanId=r.data.id,t.ticket.CompanyId=t.ticket.avioKompanijaObj.id,e.next=29,t.api.saveTicket(t.ticket);case 29:if(o=e.sent,!(t.passangers.length>0)){e.next=43;break}return e.next=33,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 33:e.t0=l.a.keys(t.passangers);case 34:if((e.t1=e.t0()).done){e.next=41;break}return c=e.t1.value,t.passangers[c].TicketId=o.data.id,e.next=39,t.api.savePassanger(t.passangers[c]);case 39:e.next=34;break;case 41:e.next=45;break;case 43:return e.next=45,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 45:t.proceed=!0,t.loadingMessage="Kreiranje avio karte u uspešno",t.showLoading=!1,Ne.push({path:"/dashboard/plans"}),e.next=57;break;case 51:e.prev=51,e.t2=e.catch(2),t.loadingMessage="Kreiranje avio karte u neuspešno",t.showLoading=!1,console.error(e.t2),w.error("Neuspesno upisivanje prodaje "+e.t2.toString());case 57:case"end":return e.stop()}},e,t,[[2,51]])}))()},checkoutUpdate:function(){var t=this;return v()(l.a.mark(function e(){var a,n,s,r,i,o,c;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.$refs.checkout.valid){e.next=59;break}return e.prev=1,t.loadingMessage="Izmena avio karte u toku",t.showLoading=!0,e.next=6,t.api.saveCustomer(t.customer);case 6:return a=e.sent,e.next=9,t.api.saveDestination(t.ticket.putovanjeOdObj);case 9:return n=e.sent,e.next=12,t.api.saveDestination(t.ticket.putovanjeDoObj);case 12:return s=e.sent,t.checkout.customerId=a.data.id,e.next=16,t.api.updatePlan(t.checkout);case 16:if(r=e.sent,null!==t.ticket.avioKompanijaObj){e.next=22;break}return e.next=20,t.api.addCompany(new N(null,t.$refs.ticket.searchComp));case 20:i=e.sent,t.ticket.avioKompanijaObj=i.data;case 22:return t.ticket.DestinationId=n.data.id,t.ticket.ArrivalId=s.data.id,t.ticket.ClientId=a.data.id,t.ticket.PlanId=r.data.id,t.ticket.CompanyId=t.ticket.avioKompanijaObj.id,e.next=29,t.api.saveChangedTicket(t.ticket);case 29:return o=e.sent,e.next=32,t.api.removeAllPassangersFromTicket(o.data.id);case 32:if(!(t.passangers.length>0)){e.next=45;break}return e.next=35,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 35:e.t0=l.a.keys(t.passangers);case 36:if((e.t1=e.t0()).done){e.next=43;break}return c=e.t1.value,t.passangers[c].TicketId=o.data.id,e.next=41,t.api.savePassanger(t.passangers[c]);case 41:e.next=36;break;case 43:e.next=47;break;case 45:return e.next=47,t.api.addClientAsPassanger(o.data.id,a.data.id,t.customer.brojRezervacije);case 47:t.loadingMessage="Kreiranje avio karte je uspela",t.showLoading=!1,t.proceed=!0,Ne.push({path:"/dashboard/plans"}),e.next=59;break;case 53:e.prev=53,e.t2=e.catch(1),t.loadingMessage="Izmena avio karte nije uspela",t.showLoading=!1,console.error(e.t2),w.error("Neuspesno upisivanje prodaje "+e.t2.toString());case 59:case"end":return e.stop()}},e,t,[[1,53]])}))()}},mounted:function(){void 0!==this.$route.params.id&&this.getPlan(this.$route.params.id),console.log(this.$route.params.id)},beforeRouteLeave:function(t,e,a){2!=this.step||this.proceed?a():(this.step=1,a(!1))}},$e={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("v-card",[2==t.step?a("v-layout",{attrs:{row:"","px-5":"","py-4":""}},[a("ticket-details",{attrs:{ticket:t.ticketSummary}})],1):t._e()],1),t._v(" "),a("v-stepper",{attrs:{vertical:""},model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("v-stepper-step",{attrs:{complete:t.step>1,step:"1"}},[t._v("\n      "+t._s(t.getHeader)+"\n    ")]),t._v(" "),a("v-stepper-content",{attrs:{step:"1"}},[a("v-subheader",[t._v("Podatci o putniku")]),t._v(" "),a("customer",{ref:"customer",attrs:{customer:t.customer},on:{newCustomer:function(e){t.newCustomerInstance()}}}),t._v(" "),a("v-divider"),t._v(" "),a("v-subheader",[t._v("Avio Karta")]),t._v(" "),a("ticket",{ref:"ticket",attrs:{ticket:t.ticket,passangers:t.passangers},on:{removePassanger:t.removePassanger}}),t._v(" "),a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{sm12:"",md5:"","ml-3":""}},[a("v-text-field",{attrs:{label:"Broj rezervacije kupca karte",rules:t.brojRezervacijeRules},model:{value:t.customer.brojRezervacije,callback:function(e){t.$set(t.customer,"brojRezervacije",e)},expression:"customer.brojRezervacije"}})],1)],1),t._v(" "),a("v-btn",{attrs:{color:"primary"},on:{click:function(e){t.toCheckout()}}},[t._v("Naplati")]),t._v(" "),a("v-btn",{attrs:{flat:""}},[t._v("Obustavi")])],1),t._v(" "),a("v-stepper-step",{attrs:{complete:t.step>2,step:"2"}},[t._v("\n      Naplata\n      ")]),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[a("checkout",{ref:"checkout",attrs:{checkout:t.checkout}}),t._v(" "),t.isEditMode?t._e():a("v-btn",{attrs:{color:"primary"},on:{click:t.checkoutEnd}},[t._v("Zakljuci Prodaju")]),t._v(" "),t.isEditMode?a("v-btn",{attrs:{color:"primary"},on:{click:t.checkoutUpdate}},[t._v("Sacuvaj Promene")]):t._e(),t._v(" "),a("v-btn",{attrs:{flat:""},on:{click:function(e){t.step=1}}},[t._v("Nazad")])],1)],1),t._v(" "),a("v-dialog",{attrs:{"hide-overlay":"",persistent:"",width:"300"},model:{value:t.showLoading,callback:function(e){t.showLoading=e},expression:"showLoading"}},[a("v-card",{attrs:{color:"blue darken-3"}},[a("v-card-text",{staticStyle:{color:"#fff"},attrs:{"text-center":""}},[t._v("\n        "+t._s(t.loadingMessage)+"\n        "),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1)],1)},staticRenderFns:[]};var Le=a("VU/8")(Ue,$e,!1,function(t){a("qoHX")},null,null).exports;n.default.use(i.a);var Ne=new i.a({routes:[{path:"/",name:"Login",component:M},{path:"/arrangement",name:"Arrangement",component:be},{path:"/dashboard",name:"Dashboard",component:ee,children:[{path:"",name:"Navigation",component:Xt},{path:"settings",name:"Settings",component:G},{path:"users",name:"UsersList",component:dt},{path:"customers",name:"CustomersList",component:ue},{path:"arrangements",name:"ArrangementsList",component:Ut},{path:"plans",name:"PlansList",component:st},{path:"tickets-store/:type",name:"TicketStore",component:Le},{path:"flight-tickets-store",name:"FlightTicketStore",component:Ye},{path:"flight-tickets-store/:id",name:"FlightTicketStore",component:Ye},{path:"bus-tickets-store",name:"BusTicketStore",component:ze},{path:"bus-tickets-store/:id",name:"BusTicketStore",component:ze},{path:"tickets/:type",name:"TicketsList",component:bt},{path:"arrangment-store",name:"ArrangmentStore",component:Ce},{path:"arrangment-store/:id",name:"ArrangmentStore",component:Ce}]}],mode:"history"}),Ee=a("NYxO");n.default.use(Ee.a);var Ve=new Ee.a.Store({state:{user:{},plan:{},room:{},customer:{},currentPassenger:{},tickets:[],passangers:[],arrangements:[],allPassangers:[],editingTicket:{},dinarEuroDiffernece:0},mutations:{setFlightTicket:function(t,e){t.editingTicket=e},setRoom:function(t,e){t.room=e},setCustomer:function(t,e){t.customer=e},setCurrentPassenger:function(t,e){t.currentPassenger=e},setCustomerId:function(t,e){t.customer.id=e},setCurrentPassengerId:function(t,e){t.currentPassenger.id=e},storePassenger:function(t){t.passangers.push(t.currentPassenger),t.currentPassenger={}},removePassanger:function(t,e){t.passangers=t.passangers.filter(function(t,a){return a!==e})},removeAllPassanger:function(t){t.allPassangers=t.allPassangers.concat(t.passangers),t.passangers=[]},addFlightTickets:function(t,e){e.forEach(function(e){return t.tickets.push(e)})},addFlightTicket:function(t,e){t.tickets.push(e)},addArrangement:function(t,e){t.arrangements.push(e)},addMultipleArrangement:function(t,e){e.forEach(function(e){return t.arrangements.push(e)})},setAllFlightTickets:function(t,e){t.tickets=e},setAllArrangement:function(t,e){t.arrangements=e},removeFlightTicket:function(t,e){t.tickets=t.tickets.filter(function(t,a){return a!==e})},removeArrangement:function(t,e){t.arrangements=t.arrangements.filter(function(t,a){return a!==e})},setPlan:function(t,e){t.plan=e},setCurrencyDifference:function(t,e){t.dinarEuroDiffernece=e},setLoggedInUser:function(t,e){t.user=e}},getters:{getEditingFlightTicket:function(t){return t.editingTicket},getPlan:function(t){return t.plan},getRoom:function(t){return t.room},getCustomerId:function(t){return t.customer.id},getCustomer:function(t){return t.customer},getCurentPassengerId:function(t){return t.currentPassenger.id},getCurrentPassenger:function(t){return t.currentPassenger},getCurentPassengers:function(t){return t.passangers},getFlightTickets:function(t){return t.tickets},getAllPassengers:function(t){return t.allPassangers},getPassangerById:function(t,e){var a;return t.allPassangers.forEach(function(t){t.id===e&&(a=t)}),a},getArrangements:function(t){return t.arrangements},getCurrencyDifference:function(t){return t.dinarEuroDiffernece},getUser:function(t){return t.user},isLoggedIn:function(t){return void 0!==t.user.id}},actions:{storePushPassanger:function(t,e){t.commit("setCurrentPassenger",e)},storePushPassangerToGroup:function(t,e){t.commit("storePassenger")},restartPlan:function(t,e){t.commit("setPlan",{}),t.commit("setCustomer",{}),t.commit("removeAllPassanger",{}),t.commit("setCurrentPassenger",{}),t.commit("setAllArrangement",[]),t.commit("setAllFlightTickets",[])}}});Ne.beforeEach(function(t,e,a){if(Ve.getters.isLoggedIn||"Login"===t.name)a();else if(window.localStorage.getItem("user")){var n=JSON.parse(window.localStorage.getItem("user"));Ve.commit("setLoggedInUser",n),a()}else a("login")});var He={name:"App",components:{navigation:Xt},computed:{isCurrentProductPlacement:function(){return"ProductPlacement"!==Ne.history.current.name},isLoginScreen:function(){return"Login"===Ne.history.current.name},isLoggedIn:function(){return this.$store.getters.isLoggedIn}},methods:{toCheckout:function(){Ne.push("check-out")}}},Fe={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var Ke=a("VU/8")(He,Fe,!1,function(t){a("WPx2")},null,null).exports,Be=a("sUu7"),qe=a("PlbA"),Ze=a.n(qe),We=a("IxQU"),Ge=a("IHMs"),Je=a.n(Ge);n.default.use(r.a,{theme:{primary:Je.a.teal.darken4,accent:Je.a.teal.accent4,secondary:Je.a.amber.base,info:Je.a.lightBlue.base,warning:Je.a.orange.darken2,error:Je.a.red.lighten1,success:Je.a.green.lighten1}}),n.default.use(We.a),n.default.use(Ze.a),n.default.use(Pt.a),n.default.config.productionTip=!1,n.default.use(Be.a),new n.default({store:Ve,el:"#app",router:Ne,components:{App:Ke},template:"<App/>"})},Sg4L:function(t,e){},UWks:function(t,e){},WPx2:function(t,e){},Whph:function(t,e){},YL6M:function(t,e){},ZqOc:function(t,e){},dZyw:function(t,e){},gBjA:function(t,e){},jMqY:function(t,e){},lE22:function(t,e){},me3Y:function(t,e){},pTBM:function(t,e){},qCRJ:function(t,e){},qoHX:function(t,e){},sbBt:function(t,e){},uslO:function(t,e,a){var n={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function s(t){return a(r(t))}function r(t){var e=n[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}s.keys=function(){return Object.keys(n)},s.resolve=r,t.exports=s,s.id="uslO"},yikG:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.680838b7e0ccc9e45421.js.map